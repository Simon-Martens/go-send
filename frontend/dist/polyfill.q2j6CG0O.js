function ct(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e,r,t){return r&&ct(e.prototype,r),e}function je(){return je=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},je.apply(this,arguments)}var Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:function(e){return"Symbol("+e+")"},mt=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function Fe(){}function ht(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis}var ar=ht(),bt={default:Fe},ir=Number.isNaN||function(e){return e!==e};function vt(e,r){return r={exports:{}},e(r,r.exports),r.exports}function _e(e){return e&&e.default||e}_e(bt);var _=vt(function(e,r){var t=Z('is "detached" for our purposes');r.typeIsObject=function(i){return typeof i=="object"&&i!==null||typeof i=="function"},r.createDataProperty=function(i,l,n){Object.defineProperty(i,l,{value:n,writable:!0,enumerable:!0,configurable:!0})},r.createArrayFromList=function(i){return i.slice()},r.ArrayBufferCopy=function(i,l,n,s,u){new Uint8Array(i).set(new Uint8Array(n,s,u),l)},r.IsFiniteNonNegativeNumber=function(i){return!(r.IsNonNegativeNumber(i)===!1||i===1/0)},r.IsNonNegativeNumber=function(i){return!(typeof i!="number"||ir(i)||i<0)};function a(i,l,n){if(typeof i!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(i,l,n)}r.Call=a,r.CreateAlgorithmFromUnderlyingMethod=function(i,l,n,s){var u=i[l];if(u!==void 0){if(typeof u!="function")throw new TypeError(u+" is not a method");switch(n){case 0:return function(){return o(u,i,s)};case 1:return function(f){var d=[f].concat(s);return o(u,i,d)}}}return function(){return Promise.resolve()}},r.InvokeOrNoop=function(i,l,n){var s=i[l];if(s!==void 0)return a(s,i,n)};function o(i,l,n){try{return Promise.resolve(a(i,l,n))}catch(s){return Promise.reject(s)}}r.PromiseCall=o,r.TransferArrayBuffer=function(i){var l=i.slice();return Object.defineProperty(i,"byteLength",{get:function(){return 0}}),i[t]=!0,l},r.IsDetachedBuffer=function(i){return t in i},r.ValidateAndNormalizeHighWaterMark=function(i){if(i=Number(i),ir(i)||i<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return i},r.MakeSizeAlgorithmFromSizeFunction=function(i){if(i===void 0)return function(){return 1};if(typeof i!="function")throw new TypeError("size property of a queuing strategy must be a function");return function(l){return i(l)}},r.PerformPromiseThen=function(i,l,n){return Promise.prototype.then.call(i,l,n)},r.WaitForAll=function(i,l,n){for(var s=!1,u=function(R){s===!1&&(s=!0,n(R))},f=0,d=0,h=i.length,g=new Array(h),p=function(R){var C=i[R],W=f,q=function(c){g[W]=c,++d,d===h&&l(g)};r.PerformPromiseThen(C,q,u),++f},S=0;S<i.length;S++)p(S)},r.WaitForAllPromise=function(i,l,n){n===void 0&&(n=void 0);var s,u,f=new Promise(function(g,p){s=g,u=p});n===void 0&&(n=function(p){throw p});var d=function(p){try{var S=l(p);s(S)}catch(b){u(b)}},h=function(p){try{var S=n(p);s(S)}catch(b){u(b)}};return r.WaitForAll(i,d,h),f}}),_t=_.typeIsObject,St=_.createDataProperty,yt=_.createArrayFromList,pt=_.ArrayBufferCopy,gt=_.IsFiniteNonNegativeNumber,Rt=_.IsNonNegativeNumber,wt=_.Call,Pt=_.CreateAlgorithmFromUnderlyingMethod,Ct=_.InvokeOrNoop,Wt=_.PromiseCall;_.TransferArrayBuffer;_.IsDetachedBuffer;var At=_.ValidateAndNormalizeHighWaterMark,Tt=_.MakeSizeAlgorithmFromSizeFunction,qt=_.PerformPromiseThen,Et=_.WaitForAll,jt=_.WaitForAllPromise;function Bt(e){return e}function zt(e){return!1}var kt={TransferArrayBuffer:Bt,IsDetachedBuffer:zt,typeIsObject:_t,createDataProperty:St,createArrayFromList:yt,ArrayBufferCopy:pt,IsFiniteNonNegativeNumber:gt,IsNonNegativeNumber:Rt,Call:wt,CreateAlgorithmFromUnderlyingMethod:Pt,InvokeOrNoop:Ct,PromiseCall:Wt,ValidateAndNormalizeHighWaterMark:At,MakeSizeAlgorithmFromSizeFunction:Tt,PerformPromiseThen:qt,WaitForAll:Et,WaitForAllPromise:jt};function yr(){}yr.AssertionError=Fe;var Ft={default:yr},It=_e(Ft),Dt=function(r){r&&r instanceof It.AssertionError&&setTimeout(function(){throw r},0)},pr={rethrowAssertionErrorRejection:Dt},m=_e(kt),Ot=m.IsFiniteNonNegativeNumber,Nt=function(r){var t=r._queue.shift();return r._queueTotalSize-=t.size,r._queueTotalSize<0&&(r._queueTotalSize=0),t.value},Mt=function(r,t,a){if(a=Number(a),!Ot(a))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");r._queue.push({value:t,size:a}),r._queueTotalSize+=a},Lt=function(r){var t=r._queue[0];return t.value},$t=function(r){r._queue=[],r._queueTotalSize=0},M={DequeueValue:Nt,EnqueueValueWithSize:Mt,PeekQueueValue:Lt,ResetQueue:$t},Vt={default:Fe},gr=_e(Vt);gr("streams:writable-stream:verbose");var We=m.CreateAlgorithmFromUnderlyingMethod,Ut=m.InvokeOrNoop,Ht=m.ValidateAndNormalizeHighWaterMark;m.IsNonNegativeNumber;var Yt=m.MakeSizeAlgorithmFromSizeFunction,Ie=m.typeIsObject,De=pr.rethrowAssertionErrorRejection,Rr=M.DequeueValue,wr=M.EnqueueValueWithSize,Qt=M.PeekQueueValue,Pr=M.ResetQueue,Cr=Z("[[AbortSteps]]"),Wr=Z("[[ErrorSteps]]"),Ar=function(){function e(t,a){t===void 0&&(t={}),a===void 0&&(a={}),qr(this);var o=a.size,i=a.highWaterMark,l=t.type;if(l!==void 0)throw new RangeError("Invalid type is specified");var n=Yt(o);i===void 0&&(i=1),i=Ht(i),ua(this,t,i,n)}var r=e.prototype;return r.abort=function(a){return K(this)===!1?Promise.reject(Ae("abort")):ue(this)===!0?Promise.reject(new TypeError("Cannot abort a stream that already has a writer")):Oe(this,a)},r.getWriter=function(){if(K(this)===!1)throw Ae("getWriter");return Tr(this)},P(e,[{key:"locked",get:function(){if(K(this)===!1)throw Ae("locked");return ue(this)}}]),e}(),w={AcquireWritableStreamDefaultWriter:Tr,CreateWritableStream:Gt,IsWritableStream:K,IsWritableStreamLocked:ue,WritableStream:Ar,WritableStreamAbort:Oe,WritableStreamDefaultControllerErrorIfNeeded:Ve,WritableStreamDefaultWriterCloseWithErrorPropagation:oa,WritableStreamDefaultWriterRelease:Br,WritableStreamDefaultWriterWrite:zr,WritableStreamCloseQueuedOrInFlight:N};function Tr(e){return new aa(e)}function Gt(e,r,t,a,o,i){o===void 0&&(o=1),i===void 0&&(i=function(){return 1});var l=Object.create(Ar.prototype);qr(l);var n=Object.create(kr.prototype);return Fr(l,n,e,r,t,a,o,i),l}function qr(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=[],e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function K(e){return!(!Ie(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController"))}function ue(e){return e._writer!==void 0}function Oe(e,r){var t=e._state;if(t==="closed"||t==="errored")return Promise.resolve(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;var a=!1;t==="erroring"&&(a=!0,r=void 0);var o=new Promise(function(i,l){e._pendingAbortRequest={_resolve:i,_reject:l,_reason:r,_wasAlreadyErroring:a}});return e._pendingAbortRequest._promise=o,a===!1&&Me(e,r),o}function Jt(e){var r=new Promise(function(t,a){var o={_resolve:t,_reject:a};e._writeRequests.push(o)});return r}function Ne(e,r){var t=e._state;if(t==="writable"){Me(e,r);return}Le(e)}function Me(e,r){var t=e._writableStreamController;e._state="erroring",e._storedError=r;var a=e._writer;a!==void 0&&jr(a,r),ea(e)===!1&&t._started===!0&&Le(e)}function Le(e){e._state="errored",e._writableStreamController[Wr]();for(var r=e._storedError,t=0,a=e._writeRequests;t<a.length;t++){var o=a[t];o._reject(r)}if(e._writeRequests=[],e._pendingAbortRequest===void 0){re(e);return}var i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring===!0){i._reject(r),re(e);return}var l=e._writableStreamController[Cr](i._reason);l.then(function(){i._resolve(),re(e)},function(n){i._reject(n),re(e)})}function Kt(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Xt(e,r){e._inFlightWriteRequest._reject(r),e._inFlightWriteRequest=void 0,Ne(e,r)}function Zt(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0;var r=e._state;r==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";var t=e._writer;t!==void 0&&Sa(t)}function xt(e,r){e._inFlightCloseRequest._reject(r),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(r),e._pendingAbortRequest=void 0),Ne(e,r)}function N(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function ea(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function ra(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function ta(e){e._inFlightWriteRequest=e._writeRequests.shift()}function re(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);var r=e._writer;r!==void 0&&(Or(r,e._storedError),r._closedPromise.catch(function(){}))}function $e(e,r){var t=e._writer;t!==void 0&&r!==e._backpressure&&(r===!0?ga(t):Nr(t)),e._backpressure=r}var aa=function(){function e(t){if(K(t)===!1)throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(ue(t)===!0)throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;var a=t._state;if(a==="writable")N(t)===!1&&t._backpressure===!0?ya(this):lr(this),or(this);else if(a==="erroring")nr(this,t._storedError),this._readyPromise.catch(function(){}),or(this);else if(a==="closed")lr(this),va(this);else{var o=t._storedError;nr(this,o),this._readyPromise.catch(function(){}),ba(this,o),this._closedPromise.catch(function(){})}}var r=e.prototype;return r.abort=function(a){return F(this)===!1?Promise.reject(I("abort")):this._ownerWritableStream===void 0?Promise.reject(G("abort")):ia(this,a)},r.close=function(){if(F(this)===!1)return Promise.reject(I("close"));var a=this._ownerWritableStream;return a===void 0?Promise.reject(G("close")):N(a)===!0?Promise.reject(new TypeError("cannot close an already-closing stream")):Er(this)},r.releaseLock=function(){if(F(this)===!1)throw I("releaseLock");var a=this._ownerWritableStream;a!==void 0&&Br(this)},r.write=function(a){return F(this)===!1?Promise.reject(I("write")):this._ownerWritableStream===void 0?Promise.reject(G("write to")):zr(this,a)},P(e,[{key:"closed",get:function(){return F(this)===!1?Promise.reject(I("closed")):this._closedPromise}},{key:"desiredSize",get:function(){if(F(this)===!1)throw I("desiredSize");if(this._ownerWritableStream===void 0)throw G("desiredSize");return la(this)}},{key:"ready",get:function(){return F(this)===!1?Promise.reject(I("ready")):this._readyPromise}}]),e}();function F(e){return!(!Ie(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream"))}function ia(e,r){var t=e._ownerWritableStream;return Oe(t,r)}function Er(e){var r=e._ownerWritableStream,t=r._state;if(t==="closed"||t==="errored")return Promise.reject(new TypeError("The stream (in "+t+" state) is not in the writable state and cannot be closed"));var a=new Promise(function(o,i){var l={_resolve:o,_reject:i};r._closeRequest=l});return r._backpressure===!0&&t==="writable"&&Nr(e),fa(r._writableStreamController),a}function oa(e){var r=e._ownerWritableStream,t=r._state;return N(r)===!0||t==="closed"?Promise.resolve():t==="errored"?Promise.reject(r._storedError):Er(e)}function na(e,r){e._closedPromiseState==="pending"?Or(e,r):_a(e,r),e._closedPromise.catch(function(){})}function jr(e,r){e._readyPromiseState==="pending"?pa(e,r):Ra(e,r),e._readyPromise.catch(function(){})}function la(e){var r=e._ownerWritableStream,t=r._state;return t==="errored"||t==="erroring"?null:t==="closed"?0:Ir(r._writableStreamController)}function Br(e){var r=e._ownerWritableStream,t=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");jr(e,t),na(e,t),r._writer=void 0,e._ownerWritableStream=void 0}function zr(e,r){var t=e._ownerWritableStream,a=t._writableStreamController,o=da(a,r);if(t!==e._ownerWritableStream)return Promise.reject(G("write to"));var i=t._state;if(i==="errored")return Promise.reject(t._storedError);if(N(t)===!0||i==="closed")return Promise.reject(new TypeError("The stream is closing or closed and cannot be written to"));if(i==="erroring")return Promise.reject(t._storedError);var l=Jt(t);return ca(a,r,o),l}var kr=function(){function e(){throw new TypeError("WritableStreamDefaultController cannot be constructed explicitly")}var r=e.prototype;return r.error=function(a){if(sa(this)===!1)throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");var o=this._controlledWritableStream._state;o==="writable"&&Dr(this,a)},r[Cr]=function(t){var a=this._abortAlgorithm(t);return Se(this),a},r[Wr]=function(){Pr(this)},e}();function sa(e){return!(!Ie(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream"))}function Fr(e,r,t,a,o,i,l,n){r._controlledWritableStream=e,e._writableStreamController=r,r._queue=void 0,r._queueTotalSize=void 0,Pr(r),r._started=!1,r._strategySizeAlgorithm=n,r._strategyHWM=l,r._writeAlgorithm=a,r._closeAlgorithm=o,r._abortAlgorithm=i;var s=Ue(r);$e(e,s);var u=t(),f=Promise.resolve(u);f.then(function(){r._started=!0,ye(r)},function(d){r._started=!0,Ne(e,d)}).catch(De)}function ua(e,r,t,a){var o=Object.create(kr.prototype);function i(){return Ut(r,"start",[o])}var l=We(r,"write",1,[o]),n=We(r,"close",0,[]),s=We(r,"abort",1,[]);Fr(e,o,i,l,n,s,t,a)}function Se(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function fa(e){wr(e,"close",0),ye(e)}function da(e,r){try{return e._strategySizeAlgorithm(r)}catch(t){return Ve(e,t),1}}function Ir(e){return e._strategyHWM-e._queueTotalSize}function ca(e,r,t){var a={chunk:r};try{wr(e,a,t)}catch(l){Ve(e,l);return}var o=e._controlledWritableStream;if(N(o)===!1&&o._state==="writable"){var i=Ue(e);$e(o,i)}ye(e)}function ye(e){var r=e._controlledWritableStream;if(e._started!==!1&&r._inFlightWriteRequest===void 0){var t=r._state;if(!(t==="closed"||t==="errored")){if(t==="erroring"){Le(r);return}if(e._queue.length!==0){var a=Qt(e);a==="close"?ma(e):ha(e,a.chunk)}}}}function Ve(e,r){e._controlledWritableStream._state==="writable"&&Dr(e,r)}function ma(e){var r=e._controlledWritableStream;ra(r),Rr(e);var t=e._closeAlgorithm();Se(e),t.then(function(){Zt(r)},function(a){xt(r,a)}).catch(De)}function ha(e,r){var t=e._controlledWritableStream;ta(t);var a=e._writeAlgorithm(r);a.then(function(){Kt(t);var o=t._state;if(Rr(e),N(t)===!1&&o==="writable"){var i=Ue(e);$e(t,i)}ye(e)},function(o){t._state==="writable"&&Se(e),Xt(t,o)}).catch(De)}function Ue(e){var r=Ir(e);return r<=0}function Dr(e,r){var t=e._controlledWritableStream;Se(e),Me(t,r)}function Ae(e){return new TypeError("WritableStream.prototype."+e+" can only be used on a WritableStream")}function I(e){return new TypeError("WritableStreamDefaultWriter.prototype."+e+" can only be used on a WritableStreamDefaultWriter")}function G(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function or(e){e._closedPromise=new Promise(function(r,t){e._closedPromise_resolve=r,e._closedPromise_reject=t,e._closedPromiseState="pending"})}function ba(e,r){e._closedPromise=Promise.reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function va(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}function Or(e,r){e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function _a(e,r){e._closedPromise=Promise.reject(r),e._closedPromiseState="rejected"}function Sa(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}function ya(e){e._readyPromise=new Promise(function(r,t){e._readyPromise_resolve=r,e._readyPromise_reject=t}),e._readyPromiseState="pending"}function nr(e,r){e._readyPromise=Promise.reject(r),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function lr(e){e._readyPromise=Promise.resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}function pa(e,r){e._readyPromise_reject(r),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function ga(e){e._readyPromise=new Promise(function(r,t){e._readyPromise_resolve=r,e._readyPromise_reject=t}),e._readyPromiseState="pending"}function Ra(e,r){e._readyPromise=Promise.reject(r),e._readyPromiseState="rejected"}function Nr(e){e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}var wa=w.WritableStream,Pa=m.ArrayBufferCopy,fe=m.CreateAlgorithmFromUnderlyingMethod,Ca=m.IsFiniteNonNegativeNumber,Mr=m.InvokeOrNoop,de=m.IsDetachedBuffer,pe=m.TransferArrayBuffer,Be=m.ValidateAndNormalizeHighWaterMark;m.IsNonNegativeNumber;var Wa=m.MakeSizeAlgorithmFromSizeFunction,ze=m.createArrayFromList,U=m.typeIsObject,Aa=m.WaitForAllPromise,T=pr.rethrowAssertionErrorRejection,Ta=M.DequeueValue,qa=M.EnqueueValueWithSize,H=M.ResetQueue,Ea=w.AcquireWritableStreamDefaultWriter,sr=w.IsWritableStream,ur=w.IsWritableStreamLocked,fr=w.WritableStreamAbort,ja=w.WritableStreamDefaultWriterCloseWithErrorPropagation,Ba=w.WritableStreamDefaultWriterRelease,za=w.WritableStreamDefaultWriterWrite,Te=w.WritableStreamCloseQueuedOrInFlight,He=Z("[[CancelSteps]]"),Ye=Z("[[PullSteps]]"),Lr=function(){function e(t,a){t===void 0&&(t={}),a===void 0&&(a={}),$r(this);var o=a.size,i=a.highWaterMark,l=t.type,n=String(l);if(n==="bytes"){if(o!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");i===void 0&&(i=0),i=Be(i),xa(this,t,i)}else if(l===void 0){var s=Wa(o);i===void 0&&(i=1),i=Be(i),La(this,t,i,s)}else throw new RangeError("Invalid type is specified")}var r=e.prototype;return r.cancel=function(a){return A(this)===!1?Promise.reject($("cancel")):j(this)===!0?Promise.reject(new TypeError("Cannot cancel a stream that already has a reader")):O(this,a)},r.getReader=function(a){var o=a===void 0?{}:a,i=o.mode;if(A(this)===!1)throw $("getReader");if(i===void 0)return Qe(this);if(i=String(i),i==="byob")return ka(this);throw new RangeError("Invalid mode is specified")},r.pipeThrough=function(a,o){var i=a.writable,l=a.readable,n=o===void 0?{}:o,s=n.preventClose,u=n.preventAbort,f=n.preventCancel,d=n.signal;if(A(this)===!1)throw $("pipeThrough");if(sr(i)===!1)throw new TypeError("writable argument to pipeThrough must be a WritableStream");if(A(l)===!1)throw new TypeError("readable argument to pipeThrough must be a ReadableStream");if(s=!!s,u=!!u,f=!!f,d!==void 0&&!mr(d))throw new TypeError("ReadableStream.prototype.pipeThrough's signal option must be an AbortSignal");if(j(this)===!0)throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ur(i)===!0)throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");var h=dr(this,i,s,u,f,d);return h.catch(function(){}),l},r.pipeTo=function(a,o){var i=o===void 0?{}:o,l=i.preventClose,n=i.preventAbort,s=i.preventCancel,u=i.signal;return A(this)===!1?Promise.reject($("pipeTo")):sr(a)===!1?Promise.reject(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream")):(l=!!l,n=!!n,s=!!s,u!==void 0&&!mr(u)?Promise.reject(new TypeError("ReadableStream.prototype.pipeTo's signal option must be an AbortSignal")):j(this)===!0?Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ur(a)===!0?Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):dr(this,a,l,n,s,u))},r.tee=function(){if(A(this)===!1)throw $("tee");var a=Fa(this);return ze(a)},P(e,[{key:"locked",get:function(){if(A(this)===!1)throw $("locked");return j(this)}}]),e}(),k={CreateReadableStream:ke,ReadableStream:Lr,ReadableStreamDefaultControllerClose:me,ReadableStreamDefaultControllerEnqueue:he,ReadableStreamDefaultControllerError:z,ReadableStreamDefaultControllerGetDesiredSize:Ze,ReadableStreamDefaultControllerHasBackpressure:Ma,ReadableStreamDefaultControllerCanCloseOrEnqueue:be};function ka(e){return new Oa(e)}function Qe(e){return new Da(e)}function ke(e,r,t,a,o){a===void 0&&(a=1),o===void 0&&(o=function(){return 1});var i=Object.create(Lr.prototype);$r(i);var l=Object.create(Jr.prototype);return Xr(i,l,e,r,t,a,o),i}function $r(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function A(e){return!(!U(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController"))}function j(e){return e._reader!==void 0}function dr(e,r,t,a,o,i){var l=Qe(e),n=Ea(r),s=!1,u=Promise.resolve();return new Promise(function(f,d){var h;if(i!==void 0){if(h=function(){var v=new DOMException("Aborted","AbortError"),y=[];a===!1&&y.push(function(){return r._state==="writable"?fr(r,v):Promise.resolve()}),o===!1&&y.push(function(){return e._state==="readable"?O(e,v):Promise.resolve()}),W(function(){return Aa(y.map(function(E){return E()}),function(E){return E})},!0,v)},i.aborted===!0){h();return}i.addEventListener("abort",h)}function g(){return new Promise(function(c,v){function y(E){E?c():p().then(y,v)}y(!1)})}function p(){return s===!0?Promise.resolve(!0):n._readyPromise.then(function(){return Xe(l).then(function(c){var v=c.value,y=c.done;return y===!0?!0:(u=za(n,v).catch(function(){}),!1)})})}if(R(e,l._closedPromise,function(c){a===!1?W(function(){return fr(r,c)},!0,c):q(!0,c)}),R(r,n._closedPromise,function(c){o===!1?W(function(){return O(e,c)},!0,c):q(!0,c)}),C(e,l._closedPromise,function(){t===!1?W(function(){return ja(n)}):q()}),Te(r)===!0||r._state==="closed"){var S=new TypeError("the destination writable stream closed before all data could be piped to it");o===!1?W(function(){return O(e,S)},!0,S):q(!0,S)}g().catch(function(c){u=Promise.resolve(),T(c)});function b(){var c=u;return u.then(function(){return c!==u?b():void 0})}function R(c,v,y){c._state==="errored"?y(c._storedError):v.catch(y).catch(T)}function C(c,v,y){c._state==="closed"?y():v.then(y).catch(T)}function W(c,v,y){if(s===!0)return;s=!0,r._state==="writable"&&Te(r)===!1?b().then(E):E();function E(){c().then(function(){return Y(v,y)},function(dt){return Y(!0,dt)}).catch(T)}}function q(c,v){s!==!0&&(s=!0,r._state==="writable"&&Te(r)===!1?b().then(function(){return Y(c,v)}).catch(T):Y(c,v))}function Y(c,v){Ba(n),Ke(l),i!==void 0&&i.removeEventListener("abort",h),c?d(v):f(void 0)}})}function Fa(e,r){var t=Qe(e),a=!1,o=!1,i=!1,l,n,s,u,f,d=new Promise(function(b){f=b});function h(){return Xe(t).then(function(b){var R=b.value,C=b.done;if(C===!0&&a===!1&&(o===!1&&me(s._readableStreamController),i===!1&&me(u._readableStreamController),a=!0),a!==!0){var W=R,q=R;o===!1&&he(s._readableStreamController,W),i===!1&&he(u._readableStreamController,q)}})}function g(b){if(o=!0,l=b,i===!0){var R=ze([l,n]),C=O(e,R);f(C)}return d}function p(b){if(i=!0,n=b,o===!0){var R=ze([l,n]),C=O(e,R);f(C)}return d}function S(){}return s=ke(S,h,g),u=ke(S,h,p),t._closedPromise.catch(function(b){a!==!0&&(z(s._readableStreamController,b),z(u._readableStreamController,b),a=!0)}),[s,u]}function cr(e,r){var t=new Promise(function(a,o){var i={_resolve:a,_reject:o,_forAuthorCode:r};e._reader._readIntoRequests.push(i)});return t}function Vr(e,r){var t=new Promise(function(a,o){var i={_resolve:a,_reject:o,_forAuthorCode:r};e._reader._readRequests.push(i)});return t}function O(e,r){if(e._disturbed=!0,e._state==="closed")return Promise.resolve(void 0);if(e._state==="errored")return Promise.reject(e._storedError);x(e);var t=e._readableStreamController[He](r);return t.then(function(){})}function x(e){e._state="closed";var r=e._reader;if(r!==void 0){if(D(r)===!0){for(var t=0,a=r._readRequests;t<a.length;t++){var o=a[t],i=o._resolve,l=o._forAuthorCode;i(B(void 0,!0,l))}r._readRequests=[]}oi(r)}}function B(e,r,t){var a=null;t===!0&&(a=Object.prototype);var o=Object.create(a);return Object.defineProperty(o,"value",{value:e,enumerable:!0,writable:!0,configurable:!0}),Object.defineProperty(o,"done",{value:r,enumerable:!0,writable:!0,configurable:!0}),o}function Ur(e,r){e._state="errored",e._storedError=r;var t=e._reader;if(t!==void 0){if(D(t)===!0){for(var a=0,o=t._readRequests;a<o.length;a++){var i=o[a];i._reject(r)}t._readRequests=[]}else{for(var l=0,n=t._readIntoRequests;l<n.length;l++){var s=n[l];s._reject(r)}t._readIntoRequests=[]}nt(t,r),t._closedPromise.catch(function(){})}}function Ia(e,r,t){var a=e._reader,o=a._readIntoRequests.shift();o._resolve(B(r,t,o._forAuthorCode))}function Ge(e,r,t){var a=e._reader,o=a._readRequests.shift();o._resolve(B(r,t,o._forAuthorCode))}function Hr(e){return e._reader._readIntoRequests.length}function ge(e){return e._reader._readRequests.length}function Je(e){var r=e._reader;return!(r===void 0||J(r)===!1)}function Yr(e){var r=e._reader;return!(r===void 0||D(r)===!1)}var Da=function(){function e(t){if(A(t)===!1)throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(j(t)===!0)throw new TypeError("This stream has already been locked for exclusive reading by another reader");Qr(this,t),this._readRequests=[]}var r=e.prototype;return r.cancel=function(a){return D(this)===!1?Promise.reject(ae("cancel")):this._ownerReadableStream===void 0?Promise.reject(ve("cancel")):Gr(this,a)},r.read=function(){return D(this)===!1?Promise.reject(ae("read")):this._ownerReadableStream===void 0?Promise.reject(ve("read from")):Xe(this,!0)},r.releaseLock=function(){if(D(this)===!1)throw ae("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Ke(this)}},P(e,[{key:"closed",get:function(){return D(this)===!1?Promise.reject(ae("closed")):this._closedPromise}}]),e}(),Oa=function(){function e(t){if(!A(t))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(V(t._readableStreamController)===!1)throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(j(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Qr(this,t),this._readIntoRequests=[]}var r=e.prototype;return r.cancel=function(a){return J(this)?this._ownerReadableStream===void 0?Promise.reject(ve("cancel")):Gr(this,a):Promise.reject(ie("cancel"))},r.read=function(a){return J(this)?this._ownerReadableStream===void 0?Promise.reject(ve("read from")):ArrayBuffer.isView(a)?de(a.buffer)===!0?Promise.reject(new TypeError("Cannot read into a view onto a detached ArrayBuffer")):a.byteLength===0?Promise.reject(new TypeError("view must have non-zero byteLength")):Na(this,a,!0):Promise.reject(new TypeError("view must be an array buffer view")):Promise.reject(ie("read"))},r.releaseLock=function(){if(!J(this))throw ie("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Ke(this)}},P(e,[{key:"closed",get:function(){return J(this)?this._closedPromise:Promise.reject(ie("closed"))}}]),e}();function J(e){return!(!U(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests"))}function D(e){return!(!U(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests"))}function Qr(e,r){e._ownerReadableStream=r,r._reader=e,r._state==="readable"?ri(e):r._state==="closed"?ai(e):(ti(e,r._storedError),e._closedPromise.catch(function(){}))}function Gr(e,r){var t=e._ownerReadableStream;return O(t,r)}function Ke(e){e._ownerReadableStream._state==="readable"?nt(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):ii(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._closedPromise.catch(function(){}),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function Na(e,r,t){var a=e._ownerReadableStream;return a._disturbed=!0,a._state==="errored"?Promise.reject(a._storedError):Ua(a._readableStreamController,r,t)}function Xe(e,r){r===void 0&&(r=!1);var t=e._ownerReadableStream;return t._disturbed=!0,t._state==="closed"?Promise.resolve(B(void 0,!0,r)):t._state==="errored"?Promise.reject(t._storedError):t._readableStreamController[Ye](r)}var Jr=function(){function e(){throw new TypeError}var r=e.prototype;return r.close=function(){if(te(this)===!1)throw oe("close");if(be(this)===!1)throw new TypeError("The stream is not in a state that permits close");me(this)},r.enqueue=function(a){if(te(this)===!1)throw oe("enqueue");if(be(this)===!1)throw new TypeError("The stream is not in a state that permits enqueue");return he(this,a)},r.error=function(a){if(te(this)===!1)throw oe("error");z(this,a)},r[He]=function(t){H(this);var a=this._cancelAlgorithm(t);return ce(this),a},r[Ye]=function(t){var a=this._controlledReadableStream;if(this._queue.length>0){var o=Ta(this);return this._closeRequested===!0&&this._queue.length===0?(ce(this),x(a)):X(this),Promise.resolve(B(o,!1,t))}var i=Vr(a,t);return X(this),i},P(e,[{key:"desiredSize",get:function(){if(te(this)===!1)throw oe("desiredSize");return Ze(this)}}]),e}();function te(e){return!(!U(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream"))}function X(e){var r=Kr(e);if(r!==!1){if(e._pulling===!0){e._pullAgain=!0;return}e._pulling=!0;var t=e._pullAlgorithm();t.then(function(){if(e._pulling=!1,e._pullAgain===!0)return e._pullAgain=!1,X(e)},function(a){z(e,a)}).catch(T)}}function Kr(e){var r=e._controlledReadableStream;if(be(e)===!1||e._started===!1)return!1;if(j(r)===!0&&ge(r)>0)return!0;var t=Ze(e);return t>0}function ce(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function me(e){var r=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(ce(e),x(r))}function he(e,r){var t=e._controlledReadableStream;if(j(t)===!0&&ge(t)>0)Ge(t,r,!1);else{var a;try{a=e._strategySizeAlgorithm(r)}catch(o){throw z(e,o),o}try{qa(e,r,a)}catch(o){throw z(e,o),o}}X(e)}function z(e,r){var t=e._controlledReadableStream;t._state==="readable"&&(H(e),ce(e),Ur(t,r))}function Ze(e){var r=e._controlledReadableStream,t=r._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Ma(e){return Kr(e)!==!0}function be(e){var r=e._controlledReadableStream._state;return e._closeRequested===!1&&r==="readable"}function Xr(e,r,t,a,o,i,l){r._controlledReadableStream=e,r._queue=void 0,r._queueTotalSize=void 0,H(r),r._started=!1,r._closeRequested=!1,r._pullAgain=!1,r._pulling=!1,r._strategySizeAlgorithm=l,r._strategyHWM=i,r._pullAlgorithm=a,r._cancelAlgorithm=o,e._readableStreamController=r;var n=t();Promise.resolve(n).then(function(){r._started=!0,X(r)},function(s){z(r,s)}).catch(T)}function La(e,r,t,a){var o=Object.create(Jr.prototype);function i(){return Mr(r,"start",[o])}var l=fe(r,"pull",0,[o]),n=fe(r,"cancel",1,[]);Xr(e,o,i,l,n,t,a)}var $a=function(){function e(){throw new TypeError("ReadableStreamBYOBRequest cannot be used directly")}var r=e.prototype;return r.respond=function(a){if(qe(this)===!1)throw Ee("respond");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(de(this._view.buffer)===!0)throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");Ka(this._associatedReadableByteStreamController,a)},r.respondWithNewView=function(a){if(qe(this)===!1)throw Ee("respond");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(a))throw new TypeError("You can only respond with array buffer views");if(de(a.buffer)===!0)throw new TypeError("The supplied view's buffer has been detached and so cannot be used as a response");Xa(this._associatedReadableByteStreamController,a)},P(e,[{key:"view",get:function(){if(qe(this)===!1)throw Ee("view");return this._view}}]),e}(),Va=function(){function e(){throw new TypeError("ReadableByteStreamController constructor cannot be used directly")}var r=e.prototype;return r.close=function(){if(V(this)===!1)throw Q("close");if(this._closeRequested===!0)throw new TypeError("The stream has already been closed; do not close it again!");var a=this._controlledReadableByteStream._state;if(a!=="readable")throw new TypeError("The stream (in "+a+" state) is not in the readable state and cannot be closed");Ga(this)},r.enqueue=function(a){if(V(this)===!1)throw Q("enqueue");if(this._closeRequested===!0)throw new TypeError("stream is closed or draining");var o=this._controlledReadableByteStream._state;if(o!=="readable")throw new TypeError("The stream (in "+o+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(a))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");if(de(a.buffer)===!0)throw new TypeError("Cannot enqueue a view onto a detached ArrayBuffer");Ja(this,a)},r.error=function(a){if(V(this)===!1)throw Q("error");ee(this,a)},r[He]=function(t){if(this._pendingPullIntos.length>0){var a=this._pendingPullIntos[0];a.bytesFilled=0}H(this);var o=this._cancelAlgorithm(t);return Re(this),o},r[Ye]=function(t){var a=this._controlledReadableByteStream;if(this._queueTotalSize>0){var o=this._queue.shift();this._queueTotalSize-=o.byteLength,tt(this);var i;try{i=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)}catch(f){return Promise.reject(f)}return Promise.resolve(B(i,!1,t))}var l=this._autoAllocateChunkSize;if(l!==void 0){var n;try{n=new ArrayBuffer(l)}catch(f){return Promise.reject(f)}var s={buffer:n,byteOffset:0,byteLength:l,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(s)}var u=Vr(a,t);return L(this),u},P(e,[{key:"byobRequest",get:function(){if(V(this)===!1)throw Q("byobRequest");if(this._byobRequest===void 0&&this._pendingPullIntos.length>0){var a=this._pendingPullIntos[0],o=new Uint8Array(a.buffer,a.byteOffset+a.bytesFilled,a.byteLength-a.bytesFilled),i=Object.create($a.prototype);ei(i,this,o),this._byobRequest=i}return this._byobRequest}},{key:"desiredSize",get:function(){if(V(this)===!1)throw Q("desiredSize");return ot(this)}}]),e}();function V(e){return!(!U(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream"))}function qe(e){return!(!U(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController"))}function L(e){var r=Qa(e);if(r!==!1){if(e._pulling===!0){e._pullAgain=!0;return}e._pulling=!0;var t=e._pullAlgorithm();t.then(function(){e._pulling=!1,e._pullAgain===!0&&(e._pullAgain=!1,L(e))},function(a){ee(e,a)}).catch(T)}}function Zr(e){er(e),e._pendingPullIntos=[]}function xe(e,r){var t=!1;e._state==="closed"&&(t=!0);var a=xr(r);r.readerType==="default"?Ge(e,a,t):Ia(e,a,t)}function xr(e){var r=e.bytesFilled,t=e.elementSize;return new e.ctor(e.buffer,e.byteOffset,r/t)}function se(e,r,t,a){e._queue.push({buffer:r,byteOffset:t,byteLength:a}),e._queueTotalSize+=a}function et(e,r){var t=r.elementSize,a=r.bytesFilled-r.bytesFilled%t,o=Math.min(e._queueTotalSize,r.byteLength-r.bytesFilled),i=r.bytesFilled+o,l=i-i%t,n=o,s=!1;l>a&&(n=l-r.bytesFilled,s=!0);for(var u=e._queue;n>0;){var f=u[0],d=Math.min(n,f.byteLength),h=r.byteOffset+r.bytesFilled;Pa(r.buffer,h,f.buffer,f.byteOffset,d),f.byteLength===d?u.shift():(f.byteOffset+=d,f.byteLength-=d),e._queueTotalSize-=d,rt(e,d,r),n-=d}return s}function rt(e,r,t){er(e),t.bytesFilled+=r}function tt(e){e._queueTotalSize===0&&e._closeRequested===!0?(Re(e),x(e._controlledReadableByteStream)):L(e)}function er(e){e._byobRequest!==void 0&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=void 0,e._byobRequest=void 0)}function at(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;var r=e._pendingPullIntos[0];et(e,r)===!0&&(rr(e),xe(e._controlledReadableByteStream,r))}}function Ua(e,r,t){var a=e._controlledReadableByteStream,o=1;r.constructor!==DataView&&(o=r.constructor.BYTES_PER_ELEMENT);var i=r.constructor,l=pe(r.buffer),n={buffer:l,byteOffset:r.byteOffset,byteLength:r.byteLength,bytesFilled:0,elementSize:o,ctor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(n),cr(a,t);if(a._state==="closed"){var s=new r.constructor(n.buffer,n.byteOffset,0);return Promise.resolve(B(s,!0,t))}if(e._queueTotalSize>0){if(et(e,n)===!0){var u=xr(n);return tt(e),Promise.resolve(B(u,!1,t))}if(e._closeRequested===!0){var f=new TypeError("Insufficient bytes to fill elements in the given buffer");return ee(e,f),Promise.reject(f)}}e._pendingPullIntos.push(n);var d=cr(a,t);return L(e),d}function Ha(e,r){r.buffer=pe(r.buffer);var t=e._controlledReadableByteStream;if(Je(t)===!0)for(;Hr(t)>0;){var a=rr(e);xe(t,a)}}function Ya(e,r,t){if(t.bytesFilled+r>t.byteLength)throw new RangeError("bytesWritten out of range");if(rt(e,r,t),!(t.bytesFilled<t.elementSize)){rr(e);var a=t.bytesFilled%t.elementSize;if(a>0){var o=t.byteOffset+t.bytesFilled,i=t.buffer.slice(o-a,o);se(e,i,0,i.byteLength)}t.buffer=pe(t.buffer),t.bytesFilled-=a,xe(e._controlledReadableByteStream,t),at(e)}}function it(e,r){var t=e._pendingPullIntos[0],a=e._controlledReadableByteStream;if(a._state==="closed"){if(r!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");Ha(e,t)}else Ya(e,r,t);L(e)}function rr(e){var r=e._pendingPullIntos.shift();return er(e),r}function Qa(e){var r=e._controlledReadableByteStream;if(r._state!=="readable"||e._closeRequested===!0||e._started===!1)return!1;if(Yr(r)===!0&&ge(r)>0||Je(r)===!0&&Hr(r)>0)return!0;var t=ot(e);return t>0}function Re(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ga(e){var r=e._controlledReadableByteStream;if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0){var t=e._pendingPullIntos[0];if(t.bytesFilled>0){var a=new TypeError("Insufficient bytes to fill elements in the given buffer");throw ee(e,a),a}}Re(e),x(r)}function Ja(e,r){var t=e._controlledReadableByteStream,a=r.buffer,o=r.byteOffset,i=r.byteLength,l=pe(a);if(Yr(t)===!0)if(ge(t)===0)se(e,l,o,i);else{var n=new Uint8Array(l,o,i);Ge(t,n,!1)}else Je(t)===!0?(se(e,l,o,i),at(e)):se(e,l,o,i);L(e)}function ee(e,r){var t=e._controlledReadableByteStream;t._state==="readable"&&(Zr(e),H(e),Re(e),Ur(t,r))}function ot(e){var r=e._controlledReadableByteStream,t=r._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Ka(e,r){if(r=Number(r),Ca(r)===!1)throw new RangeError("bytesWritten must be a finite");it(e,r)}function Xa(e,r){var t=e._pendingPullIntos[0];if(t.byteOffset+t.bytesFilled!==r.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(t.byteLength!==r.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");t.buffer=r.buffer,it(e,r.byteLength)}function Za(e,r,t,a,o,i,l){r._controlledReadableByteStream=e,r._pullAgain=!1,r._pulling=!1,Zr(r),r._queue=r._queueTotalSize=void 0,H(r),r._closeRequested=!1,r._started=!1,r._strategyHWM=Be(i),r._pullAlgorithm=a,r._cancelAlgorithm=o,r._autoAllocateChunkSize=l,r._pendingPullIntos=[],e._readableStreamController=r;var n=t();Promise.resolve(n).then(function(){r._started=!0,L(r)},function(s){ee(r,s)}).catch(T)}function xa(e,r,t){var a=Object.create(Va.prototype);function o(){return Mr(r,"start",[a])}var i=fe(r,"pull",0,[a]),l=fe(r,"cancel",1,[]),n=r.autoAllocateChunkSize;if(n!==void 0&&(n=Number(n),mt(n)===!1||n<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");Za(e,a,o,i,l,t,n)}function ei(e,r,t){e._associatedReadableByteStreamController=r,e._view=t}function mr(e){if(typeof e!="object"||e===null)return!1;var r=Object.getOwnPropertyDescriptor(AbortSignal.prototype,"aborted").get;try{return r.call(e),!0}catch{return!1}}function $(e){return new TypeError("ReadableStream.prototype."+e+" can only be used on a ReadableStream")}function ve(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function ae(e){return new TypeError("ReadableStreamDefaultReader.prototype."+e+" can only be used on a ReadableStreamDefaultReader")}function ri(e){e._closedPromise=new Promise(function(r,t){e._closedPromise_resolve=r,e._closedPromise_reject=t})}function ti(e,r){e._closedPromise=Promise.reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function ai(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function nt(e,r){e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function ii(e,r){e._closedPromise=Promise.reject(r)}function oi(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function ie(e){return new TypeError("ReadableStreamBYOBReader.prototype."+e+" can only be used on a ReadableStreamBYOBReader")}function oe(e){return new TypeError("ReadableStreamDefaultController.prototype."+e+" can only be used on a ReadableStreamDefaultController")}function Ee(e){return new TypeError("ReadableStreamBYOBRequest.prototype."+e+" can only be used on a ReadableStreamBYOBRequest")}function Q(e){return new TypeError("ReadableByteStreamController.prototype."+e+" can only be used on a ReadableByteStreamController")}var ni=k.ReadableStream,li=m.createDataProperty,si=function(){function e(t){var a=t.highWaterMark;li(this,"highWaterMark",a)}var r=e.prototype;return r.size=function(a){return a.byteLength},e}(),ui=m.createDataProperty,fi=function(){function e(t){var a=t.highWaterMark;ui(this,"highWaterMark",a)}var r=e.prototype;return r.size=function(){return 1},e}();gr("streams:transform-stream:verbose");var di=m.InvokeOrNoop,ci=m.CreateAlgorithmFromUnderlyingMethod,mi=m.PromiseCall,lt=m.typeIsObject,hr=m.ValidateAndNormalizeHighWaterMark;m.IsNonNegativeNumber;var br=m.MakeSizeAlgorithmFromSizeFunction,hi=k.CreateReadableStream,st=k.ReadableStreamDefaultControllerClose,bi=k.ReadableStreamDefaultControllerEnqueue,vi=k.ReadableStreamDefaultControllerError,_i=k.ReadableStreamDefaultControllerGetDesiredSize,Si=k.ReadableStreamDefaultControllerHasBackpressure,tr=k.ReadableStreamDefaultControllerCanCloseOrEnqueue,yi=w.CreateWritableStream,pi=w.WritableStreamDefaultControllerErrorIfNeeded,gi=function(){function e(r,t,a){r===void 0&&(r={}),t===void 0&&(t={}),a===void 0&&(a={});var o=t.size,i=t.highWaterMark,l=a.size,n=a.highWaterMark,s=r.writableType;if(s!==void 0)throw new RangeError("Invalid writable type specified");var u=br(o);i===void 0&&(i=1),i=hr(i);var f=r.readableType;if(f!==void 0)throw new RangeError("Invalid readable type specified");var d=br(l);n===void 0&&(n=0),n=hr(n);var h,g=new Promise(function(S){h=S});Ri(this,g,i,u,n,d),Ci(this,r);var p=di(r,"start",[this._transformStreamController]);h(p)}return P(e,[{key:"readable",get:function(){if(vr(this)===!1)throw Sr("readable");return this._readable}},{key:"writable",get:function(){if(vr(this)===!1)throw Sr("writable");return this._writable}}]),e}();function Ri(e,r,t,a,o,i){function l(){return r}function n(h){return Ti(e,h)}function s(h){return qi(e,h)}function u(){return Ei(e)}e._writable=yi(l,n,u,s,t,a);function f(){return ji(e)}function d(h){return Pe(e,h),Promise.resolve()}e._readable=hi(l,f,d,o,i),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Ce(e,!0),e._transformStreamController=void 0}function vr(e){return!(!lt(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController"))}function we(e,r){vi(e._readable._readableStreamController,r),Pe(e,r)}function Pe(e,r){ut(e._transformStreamController),pi(e._writable._writableStreamController,r),e._backpressure===!0&&Ce(e,!1)}function Ce(e,r){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=new Promise(function(t){e._backpressureChangePromise_resolve=t}),e._backpressure=r}var wi=function(){function e(){throw new TypeError("TransformStreamDefaultController instances cannot be created directly")}var r=e.prototype;return r.enqueue=function(a){if(ne(this)===!1)throw le("enqueue");ft(this,a)},r.error=function(a){if(ne(this)===!1)throw le("error");Wi(this,a)},r.terminate=function(){if(ne(this)===!1)throw le("terminate");Ai(this)},P(e,[{key:"desiredSize",get:function(){if(ne(this)===!1)throw le("desiredSize");var a=this._controlledTransformStream._readable._readableStreamController;return _i(a)}}]),e}();function ne(e){return!(!lt(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream"))}function Pi(e,r,t,a){r._controlledTransformStream=e,e._transformStreamController=r,r._transformAlgorithm=t,r._flushAlgorithm=a}function Ci(e,r){var t=Object.create(wi.prototype),a=function(n){try{return ft(t,n),Promise.resolve()}catch(s){return Promise.reject(s)}},o=r.transform;if(o!==void 0){if(typeof o!="function")throw new TypeError("transform is not a method");a=function(n){return mi(o,r,[n,t])}}var i=ci(r,"flush",0,[t]);Pi(e,t,a,i)}function ut(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function ft(e,r){var t=e._controlledTransformStream,a=t._readable._readableStreamController;if(tr(a)===!1)throw new TypeError("Readable side is not in a state that permits enqueue");try{bi(a,r)}catch(i){throw Pe(t,i),t._readable._storedError}var o=Si(a);o!==t._backpressure&&Ce(t,!0)}function Wi(e,r){we(e._controlledTransformStream,r)}function _r(e,r){var t=e._transformAlgorithm(r);return t.catch(function(a){throw we(e._controlledTransformStream,a),a})}function Ai(e){var r=e._controlledTransformStream,t=r._readable._readableStreamController;tr(t)===!0&&st(t);var a=new TypeError("TransformStream terminated");Pe(r,a)}function Ti(e,r){var t=e._transformStreamController;if(e._backpressure===!0){var a=e._backpressureChangePromise;return a.then(function(){var o=e._writable,i=o._state;if(i==="erroring")throw o._storedError;return _r(t,r)})}return _r(t,r)}function qi(e,r){return we(e,r),Promise.resolve()}function Ei(e){var r=e._readable,t=e._transformStreamController,a=t._flushAlgorithm();return ut(t),a.then(function(){if(r._state==="errored")throw r._storedError;var o=r._readableStreamController;tr(o)===!0&&st(o)}).catch(function(o){throw we(e,o),r._storedError})}function ji(e){return Ce(e,!1),e._backpressureChangePromise}var Bi={TransformStream:gi};function le(e){return new TypeError("TransformStreamDefaultController.prototype."+e+" can only be used on a TransformStreamDefaultController")}function Sr(e){return new TypeError("TransformStream.prototype."+e+" can only be used on a TransformStream")}var zi=Bi.TransformStream,ki={ReadableStream:ni,WritableStream:wa,ByteLengthQueuingStrategy:si,CountQueuingStrategy:fi,TransformStream:zi};typeof ar<"u"&&je(ar,ki);export{si as ByteLengthQueuingStrategy,fi as CountQueuingStrategy,ni as ReadableStream,zi as TransformStream,wa as WritableStream};
//# sourceMappingURL=polyfill.q2j6CG0O.js.map
