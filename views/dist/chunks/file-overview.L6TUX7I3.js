import{e as a,k as f,n as c}from"./chunk.B5PI22HI.js";var d=class extends HTMLElement{constructor(){super(),this._templateMounted=!1,this._postMountFrame=null,this.fileInfo=null,this._boundHandlers={download:this.handleDownload.bind(this)}}connectedCallback(){if(!this._templateMounted){let e=document.getElementById("file-overview-view");if(!e){console.error("Template #file-overview-view not found");return}let t=e.content.cloneNode(!0);this.appendChild(t),this._templateMounted=!0}this._postMountFrame!==null&&cancelAnimationFrame(this._postMountFrame),this._postMountFrame=requestAnimationFrame(()=>{this._postMountFrame=null,this.isConnected&&(c(this),this.setupHandlers())})}disconnectedCallback(){this._postMountFrame!==null&&(cancelAnimationFrame(this._postMountFrame),this._postMountFrame=null),this.teardownHandlers()}setupHandlers(){let e=this.querySelector('[data-action="download"]');e&&e.addEventListener("click",this._boundHandlers.download)}teardownHandlers(){let e=this.querySelector('[data-action="download"]');e&&e.removeEventListener("click",this._boundHandlers.download)}handleDownload(e){e.preventDefault();let t=new CustomEvent("download-start",{detail:{fileInfo:this.fileInfo},bubbles:!0});this.dispatchEvent(t),console.log("[file-overview] Download started")}setFileInfo(e){this.fileInfo=e,this.render()}render(){if(!this.fileInfo)return;let e=this.querySelector('[data-role="file-name"]');e&&(e.textContent=this.fileInfo.name||"Unknown file");let t=this.querySelector('[data-role="file-size"]');t&&this.fileInfo.size&&(t.textContent=a(this.fileInfo.size));let i=this.querySelector('[data-role="file-icon"]');if(i&&this.fileInfo.name&&this.fileInfo.name.toLowerCase().endsWith(".zip")&&(i.className="ri-folder-6-line h-12 w-12 flex-shrink-0 text-primary mr-4 text-5xl leading-[3rem]"),this.renderExpiryInfo(),this.isArchive())this.renderFileList();else{let n=this.querySelector('[data-role="file-list-container"]');n&&n.classList.add("hidden")}}renderExpiryInfo(){let e=this.querySelector('[data-role="expiry-info"]');if(!e)return;if(!this.fileInfo.dlimit||!this.fileInfo.expiresAt){e.classList.add("hidden");return}let t=this.fileInfo.dlimit-(this.fileInfo.dtotal||0),i=f(this.fileInfo.expiresAt-Date.now()),n=window.translate||(r=>r),s=n("downloadCount",{num:t}),l=n(i.id,i),o=n("archiveExpiryInfo",{downloadCount:s,timespan:l});e.innerHTML=o,e.classList.remove("hidden")}renderFileList(){let e=this.querySelector('[data-role="file-list-container"]');if(!e)return;let t=this.fileInfo.manifest;if(!t||!t.files||t.files.length===0){e.classList.add("hidden");return}e.classList.remove("hidden");let i=document.getElementById("file-overview-file-list");if(!i){console.error("Template #file-overview-file-list not found");return}let n=i.content.cloneNode(!0),s=n.querySelector('[data-role="file-count"]');if(s){let o=window.translate||(r=>r);s.textContent=o("fileCount",{num:t.files.length})}let l=n.querySelector('[data-role="file-list"]');l&&t.files.forEach(o=>{let r=this.createFileListItem(o);l.appendChild(r)}),e.innerHTML="",e.appendChild(n)}createFileListItem(e){let t=document.getElementById("file-overview-file-item");if(!t){let o=document.createElement("div");return o.textContent=`${e.name} (${a(e.size)})`,o.className="text-sm text-grey-80 dark:text-grey-30 p-2",o}let i=t.content.cloneNode(!0),n=i.querySelector('[data-role="item-name"]');n&&(n.textContent=e.name);let s=i.querySelector('[data-role="item-size"]');s&&(s.textContent=a(e.size));let l=i.querySelector('[data-role="file-icon"]');return l&&e.name&&e.name.toLowerCase().endsWith(".zip")&&(l.className="ri-folder-6-line h-6 w-6 text-primary flex-shrink-0 text-2xl leading-6"),i}isArchive(){return this.fileInfo.type==="send-archive"&&this.fileInfo.manifest&&this.fileInfo.manifest.files&&this.fileInfo.manifest.files.length>1}};customElements.define("file-overview-view",d);
