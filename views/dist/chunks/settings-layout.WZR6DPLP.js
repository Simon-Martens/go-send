import{g as n,i}from"./chunk.RASS3VP2.js";import"./chunk.EL6E2633.js";import{A as l}from"./chunk.NJSDOF6A.js";import"./chunk.XOPNHUSF.js";var a=class extends HTMLElement{constructor(){super(),this._templateMounted=!1,this._activeCategory=null,this._currentPanel=null,this._isAdmin=!1,this._isNonGuest=!1,this._categoryButtons=[],this._contentArea=null,this._uploadLinksNavItem=null,this._usersNavItem=null,this._logsNavItem=null,this._boundCategoryClick=this._handleCategoryClick.bind(this)}connectedCallback(){if(!this._templateMounted){let t=document.getElementById("settings-layout");if(!t){console.error("Template #settings-layout not found");return}let e=t.content.cloneNode(!0);this.appendChild(e),this._templateMounted=!0}this._isAdmin=this._checkIsAdmin(),this._isNonGuest=this._checkIsNonGuest(),this._cacheElements(),this._configureAccess(),l(this),this._attachListeners(),this._selectCategory("account")}disconnectedCallback(){this._detachListeners(),this._unmountCurrentPanel(),this._categoryButtons=[],this._contentArea=null,this._uploadLinksNavItem=null,this._usersNavItem=null,this._logsNavItem=null}_checkIsAdmin(){let t=i.user;if(!t||t.role===void 0||t.role===null)return!1;let e=t.role;if(typeof e=="number")return e===n.ADMIN;if(typeof e=="string"){let s=e.trim();if(!s)return!1;let r=Number.parseInt(s,10);return Number.isNaN(r)?s.toLowerCase()==="admin":r===n.ADMIN}return!1}_checkIsNonGuest(){let t=i.user;if(!t||t.role===void 0||t.role===null)return!1;let e=t.role;if(typeof e=="number")return e===n.ADMIN||e===n.USER;if(typeof e=="string"){let s=e.trim();if(!s)return!1;let r=Number.parseInt(s,10);if(!Number.isNaN(r))return r===n.ADMIN||r===n.USER;let o=s.toLowerCase();return o==="admin"||o==="user"}return!1}_cacheElements(){this._contentArea=this.querySelector('[data-role="content-area"]'),this._uploadLinksNavItem=this.querySelector('[data-role="upload-links-nav"]'),this._usersNavItem=this.querySelector('[data-role="users-nav"]'),this._logsNavItem=this.querySelector('[data-role="logs-nav"]');let t=this.querySelector('[data-role="category-list"]');t&&(this._categoryButtons=Array.from(t.querySelectorAll("button[data-category]")))}_configureAccess(){this._uploadLinksNavItem&&this._uploadLinksNavItem.classList.toggle("hidden",!this._isNonGuest),this._usersNavItem&&this._usersNavItem.classList.toggle("hidden",!this._isAdmin),this._logsNavItem&&this._logsNavItem.classList.toggle("hidden",!this._isNonGuest)}_attachListeners(){this._categoryButtons.forEach(t=>{t.addEventListener("click",this._boundCategoryClick)})}_detachListeners(){this._categoryButtons.forEach(t=>{t.removeEventListener("click",this._boundCategoryClick)})}_handleCategoryClick(t){let s=t.currentTarget.getAttribute("data-category");s&&this._selectCategory(s)}_selectCategory(t){if(this._activeCategory!==t){if(t==="users"&&!this._isAdmin){console.warn("[SettingsLayout] Non-admin attempted to access users panel");return}if(t==="upload-links"&&!this._isNonGuest){console.warn("[SettingsLayout] Guest attempted to access upload-links panel");return}if(t==="logs"&&!this._isNonGuest){console.warn("[SettingsLayout] Guest attempted to access logs panel");return}this._activeCategory=t,this._updateCategoryStyles(),this._mountPanel(t)}}_updateCategoryStyles(){this._categoryButtons.forEach(t=>{t.getAttribute("data-category")===this._activeCategory?(t.classList.add("border-primary","bg-primary/5","text-primary","dark:text-primary"),t.classList.remove("border-transparent","text-grey-70","dark:text-grey-30")):(t.classList.remove("border-primary","bg-primary/5","text-primary","dark:text-primary"),t.classList.add("border-transparent","text-grey-70","dark:text-grey-30"))})}_mountPanel(t){if(this._unmountCurrentPanel(),!this._contentArea){console.error("[SettingsLayout] Content area not found");return}let e;switch(t){case"account":e=document.createElement("settings-account-panel");break;case"upload-links":if(!this._isNonGuest)return;e=document.createElement("settings-upload-links-panel");break;case"users":if(!this._isAdmin)return;e=document.createElement("settings-users-panel");break;case"logs":if(!this._isNonGuest)return;e=document.createElement("settings-logs-panel");break;default:console.warn(`[SettingsLayout] Unknown category: ${t}`);return}this._currentPanel=e,this._contentArea.appendChild(e)}_unmountCurrentPanel(){this._currentPanel&&(this._currentPanel.remove(),this._currentPanel=null),this._contentArea&&(this._contentArea.innerHTML="")}};customElements.define("settings-layout",a);
