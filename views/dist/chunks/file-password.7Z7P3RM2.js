import{n as o}from"./chunk.B5PI22HI.js";var i=class extends HTMLElement{constructor(){super(),this._templateMounted=!1,this._postMountFrame=null,this._hasError=!1,this._boundHandlers={submit:this.handleSubmit.bind(this),input:this.handleInput.bind(this),toggleVisibility:this.togglePasswordVisibility.bind(this)}}connectedCallback(){if(!this._templateMounted){let e=document.getElementById("file-password-view");if(!e){console.error("Template #file-password-view not found");return}let t=e.content.cloneNode(!0);this.appendChild(t),this._templateMounted=!0}this._postMountFrame!==null&&cancelAnimationFrame(this._postMountFrame),this._postMountFrame=requestAnimationFrame(()=>{if(this._postMountFrame=null,!this.isConnected)return;o(this),this.setupHandlers();let e=this.querySelector('[data-role="password-input"]');e&&e.focus()})}disconnectedCallback(){this._postMountFrame!==null&&(cancelAnimationFrame(this._postMountFrame),this._postMountFrame=null),this.teardownHandlers()}setupHandlers(){let e=this.querySelector('[data-role="password-form"]'),t=this.querySelector('[data-role="password-input"]'),s=this.querySelector('[data-role="toggle-visibility"]');e&&e.addEventListener("submit",this._boundHandlers.submit),t&&t.addEventListener("input",this._boundHandlers.input),s&&s.addEventListener("click",this._boundHandlers.toggleVisibility)}teardownHandlers(){let e=this.querySelector('[data-role="password-form"]'),t=this.querySelector('[data-role="password-input"]'),s=this.querySelector('[data-role="toggle-visibility"]');e&&e.removeEventListener("submit",this._boundHandlers.submit),t&&t.removeEventListener("input",this._boundHandlers.input),s&&s.removeEventListener("click",this._boundHandlers.toggleVisibility)}handleSubmit(e){e.preventDefault(),e.stopPropagation();let t=this.querySelector('[data-role="password-input"]'),s=t?t.value:"";if(s.length===0)return;let r=this.querySelector('[data-role="submit"]');r&&(r.disabled=!0),this.clearError();let n=new CustomEvent("password-submit",{detail:{password:s},bubbles:!0});this.dispatchEvent(n),console.log("[file-password] Password submitted")}handleInput(e){this._hasError&&this.clearError()}togglePasswordVisibility(e){e.preventDefault();let t=this.querySelector('[data-role="password-input"]'),s=this.querySelector('[data-role="visibility-icon"]');!t||!s||(t.type==="password"?(t.type="text",s.src="/eye-off.svg"):(t.type="password",s.src="/eye.svg"),t.focus())}setError(e){this._hasError=!0;let t=this.querySelector('[data-role="password-input"]'),s=this.querySelector('[data-role="submit"]'),r=this.querySelector('[data-role="error"]');s&&(s.disabled=!1),t&&t.classList.add("border-red-600","dark:border-red-400"),r&&(r.textContent=e||"Incorrect password. Please try again.",r.classList.remove("hidden")),s&&s.classList.add("bg-red-600","hover:bg-red-700","dark:bg-red-400","dark:hover:bg-red-500"),t&&t.select()}clearError(){this._hasError=!1;let e=this.querySelector('[data-role="password-input"]'),t=this.querySelector('[data-role="submit"]'),s=this.querySelector('[data-role="error"]');e&&e.classList.remove("border-red-600","dark:border-red-400"),s&&s.classList.add("hidden"),t&&t.classList.remove("bg-red-600","hover:bg-red-700","dark:bg-red-400","dark:hover:bg-red-500")}};customElements.define("file-password-view",i);
