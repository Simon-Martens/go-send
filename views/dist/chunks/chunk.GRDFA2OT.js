import{c as N,d as st}from"./chunk.RASS3VP2.js";import{a as Z,b as C}from"./chunk.NJSDOF6A.js";import{a as S}from"./chunk.XOPNHUSF.js";var Ft={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:y,n:z,Gx:ot,Gy:rt,a:V,d:q}=Ft,Ht=8n,E=32,M=64,b=(t="")=>{throw new Error(t)},Rt=t=>typeof t=="bigint",ut=t=>typeof t=="string",Zt=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",K=(t,n)=>!Zt(t)||typeof n=="number"&&n>0&&t.length!==n?b("Uint8Array expected"):t,D=t=>new Uint8Array(t),j=t=>Uint8Array.from(t),dt=(t,n)=>t.toString(16).padStart(n,"0"),W=t=>Array.from(K(t)).map(n=>dt(n,2)).join(""),A={_0:48,_9:57,A:65,F:70,a:97,f:102},ct=t=>{if(t>=A._0&&t<=A._9)return t-A._0;if(t>=A.A&&t<=A.F)return t-(A.A-10);if(t>=A.a&&t<=A.f)return t-(A.a-10)},J=t=>{let n="hex invalid";if(!ut(t))return b(n);let e=t.length,s=e/2;if(e%2)return b(n);let r=D(s);for(let c=0,i=0;c<s;c++,i+=2){let l=ct(t.charCodeAt(i)),a=ct(t.charCodeAt(i+1));if(l===void 0||a===void 0)return b(n);r[c]=l*16+a}return r},Y=(t,n)=>K(ut(t)?J(t):j(K(t)),n),ht=()=>globalThis==null?void 0:globalThis.crypto,zt=()=>{var t;return((t=ht())==null?void 0:t.subtle)??b("crypto.subtle must be defined")},P=(...t)=>{let n=D(t.reduce((s,r)=>s+K(r).length,0)),e=0;return t.forEach(s=>{n.set(s,e),e+=s.length}),n},yt=(t=E)=>ht().getRandomValues(D(t)),X=BigInt,v=(t,n,e,s="bad number: out of range")=>Rt(t)&&n<=t&&t<e?t:b(s),o=(t,n=y)=>{let e=t%n;return e>=0n?e:n+e},pt=t=>o(t,z),bt=(t,n)=>{(t===0n||n<=0n)&&b("no inverse n="+t+" mod="+n);let e=o(t,n),s=n,r=0n,c=1n,i=1n,l=0n;for(;e!==0n;){let a=s/e,f=s%e,u=r-i*a,d=c-l*a;s=e,e=f,r=i,c=l,i=u,l=d}return s===1n?o(r,n):b("no inverse")},Pt=t=>{let n=T[t];return typeof n!="function"&&b("hashes."+t+" not set"),n},it=t=>t instanceof L?t:b("Point expected"),G=2n**256n,g=class g{constructor(n,e,s,r){S(this,"ex");S(this,"ey");S(this,"ez");S(this,"et");let c=G;this.ex=v(n,0n,c),this.ey=v(e,0n,c),this.ez=v(s,1n,c),this.et=v(r,0n,c),Object.freeze(this)}static fromAffine(n){return new g(n.x,n.y,1n,o(n.x*n.y))}static fromBytes(n,e=!1){let s=q,r=j(K(n,E)),c=n[31];r[31]=c&-129;let i=wt(r);v(i,0n,e?G:y);let a=o(i*i),f=o(a-1n),u=o(s*a+1n),{isValid:d,value:h}=Ot(f,u);d||b("bad point: y not sqrt");let x=(h&1n)===1n,w=(c&128)!==0;return!e&&h===0n&&w&&b("bad point: x==0, isLastByteOdd"),w!==x&&(h=o(-h)),new g(h,i,1n,o(h*i))}assertValidity(){let n=V,e=q,s=this;if(s.is0())throw new Error("bad point: ZERO");let{ex:r,ey:c,ez:i,et:l}=s,a=o(r*r),f=o(c*c),u=o(i*i),d=o(u*u),h=o(a*n),x=o(u*o(h+f)),w=o(d+o(e*o(a*f)));if(x!==w)throw new Error("bad point: equation left != right (1)");let _=o(r*c),U=o(i*l);if(_!==U)throw new Error("bad point: equation left != right (2)");return this}equals(n){let{ex:e,ey:s,ez:r}=this,{ex:c,ey:i,ez:l}=it(n),a=o(e*l),f=o(c*r),u=o(s*l),d=o(i*r);return a===f&&u===d}is0(){return this.equals(F)}negate(){return new g(o(-this.ex),this.ey,this.ez,o(-this.et))}double(){let{ex:n,ey:e,ez:s}=this,r=V,c=o(n*n),i=o(e*e),l=o(2n*o(s*s)),a=o(r*c),f=n+e,u=o(o(f*f)-c-i),d=a+i,h=d-l,x=a-i,w=o(u*h),_=o(d*x),U=o(u*x),R=o(h*d);return new g(w,_,R,U)}add(n){let{ex:e,ey:s,ez:r,et:c}=this,{ex:i,ey:l,ez:a,et:f}=it(n),u=V,d=q,h=o(e*i),x=o(s*l),w=o(c*d*f),_=o(r*a),U=o((e+s)*(i+l)-h-x),R=o(_-w),nt=o(_+w),et=o(x-u*h),Lt=o(U*R),Tt=o(nt*et),_t=o(U*et),Ut=o(R*nt);return new g(Lt,Tt,Ut,_t)}multiply(n,e=!0){if(!e&&(n===0n||this.is0()))return F;if(v(n,1n,z),n===1n)return this;if(this.equals(B))return Gt(n).p;let s=F,r=B;for(let c=this;n>0n;c=c.double(),n>>=1n)n&1n?s=s.add(c):e&&(r=r.add(c));return s}toAffine(){let{ex:n,ey:e,ez:s}=this;if(this.equals(F))return{x:0n,y:1n};let r=bt(s,y);return o(s*r)!==1n&&b("invalid inverse"),{x:o(n*r),y:o(e*r)}}toBytes(){let{x:n,y:e}=this.assertValidity().toAffine(),s=xt(e);return s[31]|=n&1n?128:0,s}toHex(){return W(this.toBytes())}clearCofactor(){return this.multiply(X(Ht),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let n=this.multiply(z/2n,!1).double();return z%2n&&(n=n.add(this)),n.is0()}static fromHex(n,e){return g.fromBytes(Y(n),e)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}};S(g,"BASE"),S(g,"ZERO");var L=g,B=new L(ot,rt,1n,o(ot*rt)),F=new L(0n,1n,1n,0n);L.BASE=B;L.ZERO=F;var xt=t=>J(dt(v(t,0n,G),M)).reverse(),wt=t=>X("0x"+W(j(K(t)).reverse())),m=(t,n)=>{let e=t;for(;n-- >0n;)e*=e,e%=y;return e},Xt=t=>{let e=t*t%y*t%y,s=m(e,2n)*e%y,r=m(s,1n)*t%y,c=m(r,5n)*r%y,i=m(c,10n)*c%y,l=m(i,20n)*i%y,a=m(l,40n)*l%y,f=m(a,80n)*a%y,u=m(f,80n)*a%y,d=m(u,10n)*c%y;return{pow_p_5_8:m(d,2n)*t%y,b2:e}},at=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,Ot=(t,n)=>{let e=o(n*n*n),s=o(e*e*n),r=Xt(t*s).pow_p_5_8,c=o(t*e*r),i=o(n*c*c),l=c,a=o(c*at),f=i===t,u=i===o(-t),d=i===o(-t*at);return f&&(c=l),(u||d)&&(c=a),(o(c)&1n)===1n&&(c=o(-c)),{isValid:f||u,value:c}},k=t=>pt(wt(t)),Dt=(...t)=>T.sha512Async(...t),Q=(...t)=>Pt("sha512Sync")(...t),mt=t=>{let n=t.slice(0,E);n[0]&=248,n[31]&=127,n[31]|=64;let e=t.slice(E,M),s=k(n),r=B.multiply(s),c=r.toBytes();return{head:n,prefix:e,scalar:s,point:r,pointBytes:c}},Yt=t=>Dt(Y(t,E)).then(mt),$=t=>mt(Q(Y(t,E)));var gt=t=>$(t).pointBytes;var Ct=t=>t.finish(Q(t.hashable)),Nt=(t,n,e)=>{let{pointBytes:s,scalar:r}=t,c=k(n),i=B.multiply(c).toBytes();return{hashable:P(i,s,e),finish:f=>{let u=pt(c+k(f)*r);return K(P(i,xt(u)),M)}}};var At=(t,n)=>{let e=Y(t),s=$(n),r=Q(s.prefix,e);return Ct(Nt(s,r,e))};var T={sha512Async:async(...t)=>{let n=zt(),e=P(...t);return D(await n.digest("SHA-512",e.buffer))},sha512Sync:void 0,bytesToHex:W,hexToBytes:J,concatBytes:P,mod:o,invert:bt,randomBytes:yt},H={getExtendedPublicKeyAsync:Yt,getExtendedPublicKey:$,randomPrivateKey:()=>yt(E),precompute:(t=8,n=B)=>(n.multiply(3n),n)},O=8,Vt=256,Bt=Math.ceil(Vt/O)+1,I=2**(O-1),qt=()=>{let t=[],n=B,e=n;for(let s=0;s<Bt;s++){e=n,t.push(e);for(let r=1;r<I;r++)e=e.add(n),t.push(e);n=e.double()}return t},ft,lt=(t,n)=>{let e=n.negate();return t?e:n},Gt=t=>{let n=ft||(ft=qt()),e=F,s=B,r=2**O,c=r,i=X(r-1),l=X(O);for(let a=0;a<Bt;a++){let f=Number(t&i);t>>=l,f>I&&(f-=c,t+=1n);let u=a*I,d=u,h=u+Math.abs(f)-1,x=a%2!==0,w=f<0;f===0?s=s.add(lt(x,n[d])):e=e.add(lt(w,n[h]))}return{p:e,f:s}};var tt=new TextEncoder;function St(...t){let n=t.reduce((r,c)=>r+c.length,0),e=new Uint8Array(n),s=0;for(let r of t)e.set(r,s),s+=r.length;return e}var vt=(...t)=>N(St(...t)),Et=async(...t)=>{var e;let n=St(...t);if((e=globalThis==null?void 0:globalThis.crypto)!=null&&e.subtle){let s=await globalThis.crypto.subtle.digest("SHA-512",n);return new Uint8Array(s)}return N(n)};T.sha512Sync||(T.sha512Sync=vt);T.sha512Async||(T.sha512Async=Et);H.sha512Sync||(H.sha512Sync=vt);H.sha512||(H.sha512=Et);var p={algorithm:"pbkdf2-sha256",hash:"SHA-256",iterations:6e5,saltLength:16,outputLength:32},kt=tt.encode("go-send-ed25519-seed"),It=tt.encode("go-send-x25519-seed");function tn(t=p.saltLength){if(t<=0)throw new Error("Salt length must be positive");let n=new Uint8Array(t);return crypto.getRandomValues(n),n}async function Kt(t,n,e=p){if(!t)throw new Error("Password is required for seed derivation");if(!(n instanceof Uint8Array))throw new TypeError("Salt must be a Uint8Array");let s=e.iterations||p.iterations,r=e.hash||p.hash,c=e.outputLength||p.outputLength,i=await crypto.subtle.importKey("raw",tt.encode(t),"PBKDF2",!1,["deriveBits"]),l=await crypto.subtle.deriveBits({name:"PBKDF2",salt:n,iterations:s,hash:r},i,c*8),a=new Uint8Array(l),f=await crypto.subtle.importKey("raw",a,{name:"HKDF"},!1,["deriveBits"]),u=await crypto.subtle.deriveBits({name:"HKDF",hash:"SHA-256",salt:new Uint8Array,info:kt},f,c*8),d=await crypto.subtle.deriveBits({name:"HKDF",hash:"SHA-256",salt:new Uint8Array,info:It},f,256);return a.fill(0),{edSeed:new Uint8Array(u),x25519Seed:new Uint8Array(d)}}async function nn(t,n,e=p){return Kt(t,n,e)}async function en(t,n,e=p){let{edSeed:s,x25519Seed:r}=await Kt(t,n,e),c=await gt(s),i=st.scalarMultBase(r);return r.fill(0),{seed:s,publicKey:c,encryptionPublicKey:i}}function sn(t=p){return{algorithm:t.algorithm,hash:t.hash,iterations:t.iterations,saltLength:t.saltLength,outputLength:t.outputLength}}function on(t){return t?{algorithm:t.algorithm||p.algorithm,hash:t.hash||p.hash,iterations:t.iterations||p.iterations,saltLength:t.saltLength||p.saltLength,outputLength:t.outputLength||p.outputLength}:{...p}}function rn(t){return Z(t)}function cn(t){return Z(t)}function an(t){return C(t)}async function fn(t,n){let e=C(n);try{let s=await At(e,t);return Z(s)}finally{t.fill(0)}}export{gt as a,p as b,tn as c,nn as d,en as e,sn as f,on as g,rn as h,cn as i,an as j,fn as k};
/*! Bundled license information:

@noble/ed25519/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
