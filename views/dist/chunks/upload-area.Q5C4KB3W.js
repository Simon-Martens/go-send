import{d as he,e as G,j as fe,k as ce,n as Z}from"./chunk.B5PI22HI.js";var re=class extends HTMLElement{constructor(){super(),this._afterFrame=null,this._fileInput=null,this._dragCounter=0,this._dropZone=null,this._boundFileSelect=this.handleFileSelect.bind(this),this._boundDragEnter=this.handleDragEnter.bind(this),this._boundDragOver=this.handleDragOver.bind(this),this._boundDragLeave=this.handleDragLeave.bind(this),this._boundDrop=this.handleDrop.bind(this)}connectedCallback(){this.render()}disconnectedCallback(){this._afterFrame!==null&&(cancelAnimationFrame(this._afterFrame),this._afterFrame=null),this._fileInput&&(this._fileInput.removeEventListener("change",this._boundFileSelect),this._fileInput=null),this._removeDragListeners()}render(){let e=document.getElementById("upload-view-empty");if(!e){console.error("Template #upload-view-empty not found");return}let t=e.content.cloneNode(!0);this.innerHTML="",this.appendChild(t),this._fileInput=this.querySelector("#file-upload"),this._errorEl=this.querySelector('[data-role="error"]'),this._dropZone=this.querySelector(".border-2.border-dashed"),this._fileInput&&this._fileInput.addEventListener("change",this._boundFileSelect),this._setupDragListeners(),this._afterFrame!==null&&cancelAnimationFrame(this._afterFrame),this._afterFrame=requestAnimationFrame(()=>{this._afterFrame=null,Z(this)})}setConfig({orClickText:e,addFilesLabel:t,noticeHTML:i}={}){if(typeof e=="string"){let c=this.querySelector("#orClickWithSize");c&&(c.textContent=e)}if(typeof t=="string"){let c=this.querySelector("#addFilesButton");c&&(c.textContent=t)}let v=this.querySelector("#upload-area-default-notice");v&&(i?(v.innerHTML=i,v.classList.remove("hidden")):(v.textContent="",v.classList.add("hidden")))}focusFileInput(){this._fileInput&&this._fileInput.focus()}handleFileSelect(e){let t=Array.from(e.target.files||[]);t.length!==0&&(this.dispatchEvent(new CustomEvent("addfiles",{bubbles:!0,detail:{files:t}})),e.target.value="")}setError(e){this._errorEl&&(e?(this._errorEl.textContent=e,this._errorEl.classList.remove("hidden")):(this._errorEl.textContent="",this._errorEl.classList.add("hidden")))}_setupDragListeners(){this._dropZone&&(this._dropZone.addEventListener("dragenter",this._boundDragEnter),this._dropZone.addEventListener("dragover",this._boundDragOver),this._dropZone.addEventListener("dragleave",this._boundDragLeave),this._dropZone.addEventListener("drop",this._boundDrop))}_removeDragListeners(){this._dropZone&&(this._dropZone.removeEventListener("dragenter",this._boundDragEnter),this._dropZone.removeEventListener("dragover",this._boundDragOver),this._dropZone.removeEventListener("dragleave",this._boundDragLeave),this._dropZone.removeEventListener("drop",this._boundDrop),this._dropZone=null)}handleDragEnter(e){e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer&&e.dataTransfer.types.includes("Files")&&this._showDragFeedback()}handleDragOver(e){e.preventDefault(),e.stopPropagation()}handleDragLeave(e){e.preventDefault(),e.stopPropagation(),this._dragCounter--,this._dragCounter===0&&this._hideDragFeedback()}handleDrop(e){var i;e.preventDefault(),e.stopPropagation(),this._dragCounter=0,this._hideDragFeedback();let t=Array.from(((i=e.dataTransfer)==null?void 0:i.files)||[]);t.length>0&&this.dispatchEvent(new CustomEvent("addfiles",{bubbles:!0,detail:{files:t}}))}_showDragFeedback(){this._dropZone&&(this._dropZone.classList.remove("border-grey-transparent","dark:border-grey-60"),this._dropZone.classList.add("border-primary","bg-blue-10","dark:bg-blue-90","dark:border-blue-40"))}_hideDragFeedback(){this._dropZone&&(this._dropZone.classList.remove("border-primary","bg-blue-10","dark:bg-blue-90","dark:border-blue-40"),this._dropZone.classList.add("border-grey-transparent","dark:border-grey-60"))}};customElements.define("upload-empty-view",re);var ie=class extends HTMLElement{constructor(){super(),this.elements={fileInput:null,fileList:null,uploadButton:null,totalSize:null,fileCount:null,addMoreLabel:null,expiryContainer:null,downloadLimit:null,timeLimit:null,orLabel:null,expiryLabelTop:null,expiryLabelBottom:null,passwordToggle:null,passwordToggleIcon:null,passwordField:null,passwordInput:null,passwordHint:null,passwordVisibilityButton:null,passwordVisibilityIcon:null,dropZone:null,archiveNameContainer:null,archiveNameInput:null},this._afterFrame=null,this._files=[],this._limits=null,this._defaults=null,this._maxFiles=0,this._translate=null,this._password="",this._passwordEnabled=!1,this._timeLimit=null,this._downloadLimit=null,this._errorMessage=null,this._dragCounter=0,this._boundFileSelect=this.handleFileSelect.bind(this),this._boundUploadClick=this.handleUploadClick.bind(this),this._boundTimeChange=this.handleTimeLimitChange.bind(this),this._boundDownloadChange=this.handleDownloadLimitChange.bind(this),this._boundPasswordInput=this.handlePasswordInput.bind(this),this._boundPasswordToggle=null,this._boundPasswordVisibility=null,this._boundDragEnter=this.handleDragEnter.bind(this),this._boundDragOver=this.handleDragOver.bind(this),this._boundDragLeave=this.handleDragLeave.bind(this),this._boundDrop=this.handleDrop.bind(this),this._boundArchiveNameInput=this.handleArchiveNameInput.bind(this),this._archiveNameValid=!0}connectedCallback(){this.render()}disconnectedCallback(){this._detachListeners(),this._removeDragListeners(),this._afterFrame!==null&&(cancelAnimationFrame(this._afterFrame),this._afterFrame=null)}render(){let e=document.getElementById("upload-view-list");if(!e){console.error("Template #upload-view-list not found");return}this._detachListeners();let t=e.content.cloneNode(!0);this.innerHTML="",this.appendChild(t),this.elements.fileInput=this.querySelector("#file-upload"),this.elements.fileList=this.querySelector('[data-role="file-list"]'),this.elements.uploadButton=this.querySelector('[data-action="upload"]'),this.elements.totalSize=this.querySelector('[data-role="total-size-value"]'),this.elements.fileCount=this.querySelector('[data-role="file-count-value"]'),this.elements.addMoreLabel=this.querySelector('[data-role="add-more-label"]'),this.elements.error=this.querySelector('[data-role="error"]'),this.elements.dropZone=this.querySelector(".flex.flex-col");let i=this.querySelector("#upload-area-options-slot");if(i){let v=document.getElementById("upload-view-list-options");v&&i.childElementCount===0&&i.appendChild(v.content.cloneNode(!0)),this.elements.expiryContainer=i.querySelector('[data-role="expiry-container"]'),this.elements.downloadLimit=i.querySelector('select[data-role="download-limit"]'),this.elements.timeLimit=i.querySelector('select[data-role="time-limit"]'),this.elements.orLabel=i.querySelector('[data-role="or-label"]'),this.elements.expiryLabelTop=i.querySelector('[data-role="expiry-label-top"]'),this.elements.expiryLabelBottom=i.querySelector('[data-role="expiry-label-bottom"]'),this.elements.passwordToggle=i.querySelector('[data-role="password-toggle"]'),this.elements.passwordToggleIcon=i.querySelector('[data-role="password-toggle-icon"]'),this.elements.passwordField=i.querySelector('[data-role="password-field"]'),this.elements.passwordInput=i.querySelector('[data-role="password"]'),this.elements.passwordHint=i.querySelector('[data-role="password-hint"]'),this.elements.passwordVisibilityButton=i.querySelector('[data-role="password-visibility"]'),this.elements.passwordVisibilityIcon=i.querySelector('[data-role="password-visibility-icon"]'),this.elements.archiveNameContainer=i.querySelector('[data-role="archive-name-container"]'),this.elements.archiveNameInput=i.querySelector('[data-role="archive-name"]')}this._attachBaseListeners(),this._setupDragListeners(),this._afterFrame!==null&&cancelAnimationFrame(this._afterFrame),this._afterFrame=requestAnimationFrame(()=>{this._afterFrame=null,Z(this),this.applyPasswordState()})}setState({files:e=[],totalSize:t=0,maxFiles:i=0,limits:v=null,defaults:c=null,translate:C=null,timeLimit:D=null,downloadLimit:B=null,password:N=""}={}){this._files=Array.from(e),this._maxFiles=i||0,this._limits=v,this._defaults=c,this._translate=C,typeof D=="number"&&!Number.isNaN(D)&&(this._timeLimit=D),typeof B=="number"&&!Number.isNaN(B)&&(this._downloadLimit=B);let P=typeof N=="string"&&N.length>0;this._files.length===0?(this._passwordEnabled=!1,this._password=""):P?(this._passwordEnabled=!0,this._password=N):N===null&&!this._passwordEnabled&&(this._password="");let S=t||this._files.reduce((q,$)=>q+($.size||0),0);this._renderFileList(),this._updateFileCount(),this._updateTotalSize(S),this._renderExpiryControls(),this._updateOptionValues(),this._updateStaticLabels(S),this._updateArchiveNameVisibility(),this.applyPasswordState(),this.updatePasswordHint(this._password.length),this.setError(this._errorMessage),this._updateUploadButtonState()}updateTotalSize(e){this._updateTotalSize(e)}setUploadEnabled(e){this.elements.uploadButton&&(this.elements.uploadButton.disabled=!e)}updateProgress(){}updateProgressText(){}_renderFileList(){if(!this.elements.fileList)return;this.elements.fileList.innerHTML="";let e=document.getElementById("upload-view-list-item");if(!e){console.error("Template #upload-view-list-item not found");return}this._files.forEach((t,i)=>{let v=e.content.cloneNode(!0),c=v.querySelector("li"),C=v.querySelector('[data-role="file-name"]'),D=v.querySelector('[data-role="file-meta"]'),B=v.querySelector('[data-action="remove"]'),N=v.querySelector('[data-role="remove-label"]'),P=v.querySelector('[data-role="file-icon"]');if(C&&(C.textContent=t.name||"Untitled"),D){let S=t.webkitRelativePath||"",q=G(t.size||0);D.textContent=S?`${q} \u2022 ${S}`:q}P&&t.name&&t.name.toLowerCase().endsWith(".zip")&&(P.className="ri-folder-6-line h-8 w-8 flex-shrink-0 text-primary mr-3 text-3xl leading-8"),N&&(N.textContent=this._translateText("deleteButtonHover","Remove file")),B&&(B.dataset.index=String(i),B.addEventListener("click",S=>this.handleRemoveClick(S))),c&&this.elements.fileList.appendChild(v)})}_renderExpiryControls(){var Q,J;let e=this.elements.expiryContainer,t=this.elements.downloadLimit,i=this.elements.timeLimit;if(!e||!t||!i)return;this._detachOptionListeners();let v="__DOWNLOAD__",c="__TIMESPAN__",C=`Expires after ${v} ${this._translateText("or","or")} ${c} ends`,B=this._translateText("archiveExpiryInfo",C,{downloadCount:v,timespan:c}).split(v),N=B[0]||"",S=(B[1]||"").split(c),q=S[0]||"",$=S[1]||"";if(this.elements.expiryLabelTop){let V=N.trim()||this._translateText("expiresAfterLabel","Expires after");this.elements.expiryLabelTop.textContent=V}if(this.elements.orLabel){let V=q.trim()||this._translateText("or","or");this.elements.orLabel.textContent=V}if(this.elements.expiryLabelBottom){let V=$.trim()||this._translateText("expiresAfterSuffix","");this.elements.expiryLabelBottom.textContent=V}this._downloadLimit=this._populateSelect(t,(((Q=this._defaults)==null?void 0:Q.DOWNLOAD_COUNTS)||[]).filter(V=>{var w;let Y=(w=this._limits)==null?void 0:w.MAX_DOWNLOADS;return Y?V<=Y:!0}),this._downloadLimit,V=>this._translateText("downloadCount",`${V}`,{num:V})),this._timeLimit=this._populateSelect(i,(((J=this._defaults)==null?void 0:J.EXPIRE_TIMES_SECONDS)||[]).filter(V=>{var w;let Y=(w=this._limits)==null?void 0:w.MAX_EXPIRE_SECONDS;return Y?V<=Y:!0}),this._timeLimit,V=>this._formatExpireOption(V)),this._attachOptionListeners()}_populateSelect(e,t,i,v){if(!e)return i;let c=i!=null?String(i):null;return e.innerHTML="",t.forEach(C=>{let D=document.createElement("option");D.value=String(C),D.textContent=v(C),e.appendChild(D)}),c&&Array.from(e.options).some(C=>C.value===c)?e.value=c:e.options.length>0&&(e.selectedIndex=0),e.options.length>0?Number(e.value):i}_updateOptionValues(){if(this.elements.downloadLimit&&this._downloadLimit!==null&&this._downloadLimit!==void 0){let e=String(this._downloadLimit);Array.from(this.elements.downloadLimit.options).some(t=>t.value===e)&&(this.elements.downloadLimit.value=e)}if(this.elements.timeLimit&&this._timeLimit!==null&&this._timeLimit!==void 0){let e=String(this._timeLimit);Array.from(this.elements.timeLimit.options).some(t=>t.value===e)&&(this.elements.timeLimit.value=e)}this.elements.passwordInput&&(this.elements.passwordInput.value=this._password||"")}_updateFileCount(){if(!this.elements.fileCount)return;let e=this._files.length,t=this._translateText("fileCount",e===1?"1 file":`${e} files`,{num:e}),i=this._maxFiles?this._translateText("maxFilesPerArchive",`Max ${this._maxFiles}`,{num:this._maxFiles}):"";this.elements.fileCount.textContent=i?`${t} \u2022 ${i}`:t}_updateTotalSize(e){if(!this.elements.totalSize)return;let t=G(e||0),i=this._translateText("totalSize",`${t}`,{size:t});this.elements.totalSize.textContent=i}_updateStaticLabels(e){if(this.elements.addMoreLabel&&(this.elements.addMoreLabel.textContent=this._translateText("addFilesButton","Add more files")),this.elements.uploadButton){let t=this._translateText("uploadButton","Upload"),i=this.elements.uploadButton.querySelector("#uploadButton");i?i.textContent=t:this.elements.uploadButton.textContent=t}this._updateTotalSize(e)}_updateArchiveNameVisibility(){if(this.elements.archiveNameContainer)if(this._files.length>1){let e=this.elements.archiveNameContainer.classList.contains("hidden");this.elements.archiveNameContainer.classList.remove("hidden"),e&&Z(this.elements.archiveNameContainer),this.elements.archiveNameInput&&!this.elements.archiveNameInput.value&&(this.elements.archiveNameInput.value="Send-Archive")}else this.elements.archiveNameContainer.classList.add("hidden"),this._archiveNameValid=!0,this._showArchiveNameError(null)}_attachBaseListeners(){this.elements.fileInput&&this.elements.fileInput.addEventListener("change",this._boundFileSelect),this.elements.uploadButton&&this.elements.uploadButton.addEventListener("click",this._boundUploadClick),this.elements.passwordToggle&&(this._boundPasswordToggle=this._boundPasswordToggle||this.handlePasswordToggle.bind(this),this.elements.passwordToggle.addEventListener("click",this._boundPasswordToggle)),this.elements.passwordVisibilityButton&&(this._boundPasswordVisibility=this._boundPasswordVisibility||this.togglePasswordVisibility.bind(this),this.elements.passwordVisibilityButton.addEventListener("click",this._boundPasswordVisibility)),this.elements.passwordInput&&this.elements.passwordInput.addEventListener("input",this._boundPasswordInput),this.elements.archiveNameInput&&this.elements.archiveNameInput.addEventListener("input",this._boundArchiveNameInput)}_attachOptionListeners(){this.elements.downloadLimit&&this.elements.downloadLimit.addEventListener("change",this._boundDownloadChange),this.elements.timeLimit&&this.elements.timeLimit.addEventListener("change",this._boundTimeChange)}_detachOptionListeners(){this.elements.downloadLimit&&this.elements.downloadLimit.removeEventListener("change",this._boundDownloadChange),this.elements.timeLimit&&this.elements.timeLimit.removeEventListener("change",this._boundTimeChange)}_detachListeners(){this.elements.fileInput&&this.elements.fileInput.removeEventListener("change",this._boundFileSelect),this.elements.uploadButton&&this.elements.uploadButton.removeEventListener("click",this._boundUploadClick),this.elements.passwordToggle&&this._boundPasswordToggle&&this.elements.passwordToggle.removeEventListener("click",this._boundPasswordToggle),this.elements.passwordVisibilityButton&&this._boundPasswordVisibility&&this.elements.passwordVisibilityButton.removeEventListener("click",this._boundPasswordVisibility),this.elements.passwordInput&&this.elements.passwordInput.removeEventListener("input",this._boundPasswordInput),this.elements.archiveNameInput&&this.elements.archiveNameInput.removeEventListener("input",this._boundArchiveNameInput),this._detachOptionListeners()}_formatExpireOption(e){let t=fe(e),i=this._formatDuration(e);return this._translateText(t.id,i,t)}_formatDuration(e){if(e%86400===0){let c=e/86400;return c===1?"1 day":`${c} days`}if(e%3600===0){let c=e/3600;return c===1?"1 hour":`${c} hours`}if(e%60===0){let c=e/60;return c===1?"1 minute":`${c} minutes`}return`${e} seconds`}_translateText(e,t,i){try{if(typeof this._translate=="function"){let v=this._translate(e,i);if(v)return v}else if(typeof window.translate=="function"){let v=window.translate(e,i);if(v)return v}}catch{}return t}updatePasswordHint(e){this.elements.passwordHint&&(e>=4096?this.elements.passwordHint.textContent=this._translateText("maxPasswordLength","Maximum password length",{length:4096}):this.elements.passwordHint.textContent="")}handleFileSelect(e){let t=Array.from(e.target.files||[]);t.length!==0&&(this.dispatchEvent(new CustomEvent("addfiles",{bubbles:!0,detail:{files:t}})),e.target.value="")}handleUploadClick(e){if(e.preventDefault(),this._files.length>1&&this.elements.archiveNameInput){let t=this.elements.archiveNameInput.value,i=this._validateArchiveName(t);if(i){this._archiveNameValid=!1,this._showArchiveNameError(i),this._updateUploadButtonState();return}}this.dispatchEvent(new CustomEvent("upload",{bubbles:!0}))}handleRemoveClick(e){e.preventDefault(),e.stopPropagation();let t=Number.parseInt(e.currentTarget.dataset.index,10);if(Number.isNaN(t)||t<0||t>=this._files.length)return;let[i]=this._files.splice(t,1);this._renderFileList();let v=this._files.reduce((c,C)=>c+(C.size||0),0);this._updateFileCount(),this._updateTotalSize(v),this._updateArchiveNameVisibility(),this._updateUploadButtonState(),this.dispatchEvent(new CustomEvent("removeupload",{bubbles:!0,detail:{file:i,index:t}}))}handleTimeLimitChange(e){let t=Number.parseInt(e.target.value,10);Number.isNaN(t)||(this._timeLimit=t,this.dispatchEvent(new CustomEvent("updateoptions",{bubbles:!0,detail:{timeLimit:t}})))}handleDownloadLimitChange(e){let t=Number.parseInt(e.target.value,10);Number.isNaN(t)||(this._downloadLimit=t,this.dispatchEvent(new CustomEvent("updateoptions",{bubbles:!0,detail:{downloadLimit:t}})))}handlePasswordInput(e){this._password=e.target.value,this._passwordEnabled=!0,this.updatePasswordHint(this._password.length),this.dispatchEvent(new CustomEvent("updateoptions",{bubbles:!0,detail:{password:this._password||null}}))}handleArchiveNameInput(e){let t=e.target.value,i=this._validateArchiveName(t);if(i){this._archiveNameValid=!1,this._showArchiveNameError(i),this._updateUploadButtonState();return}this._archiveNameValid=!0,this._showArchiveNameError(null),this._updateUploadButtonState();let v=t.trim();this.dispatchEvent(new CustomEvent("updateoptions",{bubbles:!0,detail:{archiveName:v||null}}))}_validateArchiveName(e){if(!e||!e.trim())return null;let t=e.trim();if(/[<>:"/\\|?*]/.test(t))return"archiveNameInvalidChars";if(/[.\s]$/.test(t))return"archiveNameInvalidEnd";let v=/^(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])$/i,c=t.replace(/\.zip$/i,"");return v.test(c)?"archiveNameReserved":null}_showArchiveNameError(e){var i;if(!this.elements.archiveNameInput)return;let t=(i=this.elements.archiveNameContainer)==null?void 0:i.querySelector('[data-role="archive-name-error"]');if(t)if(e){let v="Invalid filename";try{let c=window.translate||this._translate;if(typeof c=="function"){let C=c(e);C&&C!==e&&(v=C)}}catch(c){console.warn(`Translation failed for key: ${e}`,c)}t.textContent=v,t.classList.remove("hidden"),this.elements.archiveNameInput.classList.add("border-red-500","dark:border-red-500")}else t.textContent="",t.classList.add("hidden"),this.elements.archiveNameInput.classList.remove("border-red-500","dark:border-red-500")}_updateUploadButtonState(){if(!this.elements.uploadButton)return;let e=this._files.length>1&&!this._archiveNameValid;this.elements.uploadButton.disabled=e}setError(e){this._errorMessage=e,this.elements.error&&(e?(this.elements.error.textContent=e,this.elements.error.classList.remove("hidden")):(this.elements.error.textContent="",this.elements.error.classList.add("hidden")))}handlePasswordToggle(e){e.preventDefault(),!(!this.elements.passwordField||!this.elements.passwordToggleIcon)&&(this._passwordEnabled=!this._passwordEnabled,this._passwordEnabled||(this._password="",this.updatePasswordHint(0),this.dispatchEvent(new CustomEvent("updateoptions",{bubbles:!0,detail:{password:null}}))),this.applyPasswordState(),this._passwordEnabled&&this.elements.passwordInput&&this.elements.passwordInput.focus())}togglePasswordVisibility(e){if(e.preventDefault(),!this.elements.passwordInput||!this.elements.passwordVisibilityIcon)return;let t=this.elements.passwordInput,i=t.type==="password";t.type=i?"text":"password",this.elements.passwordVisibilityIcon.src=i?"/eye-off.svg":"/eye.svg",t.focus()}applyPasswordState(){if(!this.elements.passwordField||!this.elements.passwordToggleIcon)return;let e=this.elements.passwordToggleIcon.querySelector('[data-role="lock-icon"]');this._passwordEnabled?(this.elements.passwordField.removeAttribute("hidden"),e&&e.classList.remove("hidden"),this.elements.passwordInput&&(this.elements.passwordInput.value=this._password||"",this.elements.passwordInput.type="password"),this.elements.passwordVisibilityIcon&&(this.elements.passwordVisibilityIcon.src="/eye.svg")):(this.elements.passwordField.setAttribute("hidden","hidden"),e&&e.classList.add("hidden"),this.elements.passwordInput&&(this.elements.passwordInput.value="",this.elements.passwordInput.type="password"),this.elements.passwordVisibilityIcon&&(this.elements.passwordVisibilityIcon.src="/eye.svg"))}_setupDragListeners(){this.elements.dropZone&&(this.elements.dropZone.addEventListener("dragenter",this._boundDragEnter),this.elements.dropZone.addEventListener("dragover",this._boundDragOver),this.elements.dropZone.addEventListener("dragleave",this._boundDragLeave),this.elements.dropZone.addEventListener("drop",this._boundDrop))}_removeDragListeners(){this.elements.dropZone&&(this.elements.dropZone.removeEventListener("dragenter",this._boundDragEnter),this.elements.dropZone.removeEventListener("dragover",this._boundDragOver),this.elements.dropZone.removeEventListener("dragleave",this._boundDragLeave),this.elements.dropZone.removeEventListener("drop",this._boundDrop),this.elements.dropZone=null)}handleDragEnter(e){e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer&&e.dataTransfer.types.includes("Files")&&this._showDragFeedback()}handleDragOver(e){e.preventDefault(),e.stopPropagation()}handleDragLeave(e){e.preventDefault(),e.stopPropagation(),this._dragCounter--,this._dragCounter===0&&this._hideDragFeedback()}handleDrop(e){var i;e.preventDefault(),e.stopPropagation(),this._dragCounter=0,this._hideDragFeedback();let t=Array.from(((i=e.dataTransfer)==null?void 0:i.files)||[]);t.length>0&&this.dispatchEvent(new CustomEvent("addfiles",{bubbles:!0,detail:{files:t}}))}_showDragFeedback(){this.elements.dropZone&&this.elements.dropZone.classList.add("ring-2","ring-primary","ring-inset","bg-blue-10","dark:bg-blue-90")}_hideDragFeedback(){this.elements.dropZone&&this.elements.dropZone.classList.remove("ring-2","ring-primary","ring-inset","bg-blue-10","dark:bg-blue-90")}};customElements.define("upload-list-view",ie);var ne=class extends HTMLElement{constructor(){super(),this._afterFrame=null,this._progressBar=null,this._progressPercent=null,this._boundHandleCancel=this.handleCancel.bind(this)}connectedCallback(){this.render(),this.addEventListener("click",this._boundHandleCancel)}disconnectedCallback(){this.removeEventListener("click",this._boundHandleCancel),this._afterFrame!==null&&(cancelAnimationFrame(this._afterFrame),this._afterFrame=null)}render(){let e=document.getElementById("upload-view-uploading");if(!e){console.error("Template #upload-view-uploading not found");return}let t=e.content.cloneNode(!0);this.innerHTML="",this.appendChild(t),this._progressBar=this.querySelector('[data-role="progress-bar"]'),this._progressPercent=this.querySelector('[data-role="progress-percent"]'),this._afterFrame!==null&&cancelAnimationFrame(this._afterFrame),this._afterFrame=requestAnimationFrame(()=>{this._afterFrame=null,Z(this)})}handleCancel(e){e.target.closest('[data-action="cancel"]')&&(e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{bubbles:!0,composed:!0})))}updateProgress(e,t,i){if(this._progressBar&&(this._progressBar.value=e),this._progressPercent){let v=Math.round(e*100);this._progressPercent.textContent=`${v}%`}}setFileInfo(e,t){let i=this.querySelector('[data-role="file-name"]'),v=this.querySelector('[data-role="file-size"]');i&&(i.textContent=e),v&&(v.textContent=G(t))}setExpiryInfo(e){let t=this.querySelector('[data-role="expiry-info"]');t&&(t.textContent=e)}};customElements.define("upload-uploading-view",ne);var pe=(function(){var R=function(w,y){var g=236,_=17,a=w,p=t[y],n=null,r=0,m=null,u=[],f={},T=function(o,l){r=a*4+17,n=(function(s){for(var d=new Array(s),h=0;h<s;h+=1){d[h]=new Array(s);for(var b=0;b<s;b+=1)d[h][b]=null}return d})(r),A(0,0),A(r-7,0),A(0,r-7),O(),M(),W(o,l),a>=7&&K(o),m==null&&(m=ge(a,p,u)),X(m,l)},A=function(o,l){for(var s=-1;s<=7;s+=1)if(!(o+s<=-1||r<=o+s))for(var d=-1;d<=7;d+=1)l+d<=-1||r<=l+d||(0<=s&&s<=6&&(d==0||d==6)||0<=d&&d<=6&&(s==0||s==6)||2<=s&&s<=4&&2<=d&&d<=4?n[o+s][l+d]=!0:n[o+s][l+d]=!1)},k=function(){for(var o=0,l=0,s=0;s<8;s+=1){T(!0,s);var d=v.getLostPoint(f);(s==0||o>d)&&(o=d,l=s)}return l},M=function(){for(var o=8;o<r-8;o+=1)n[o][6]==null&&(n[o][6]=o%2==0);for(var l=8;l<r-8;l+=1)n[6][l]==null&&(n[6][l]=l%2==0)},O=function(){for(var o=v.getPatternPosition(a),l=0;l<o.length;l+=1)for(var s=0;s<o.length;s+=1){var d=o[l],h=o[s];if(n[d][h]==null)for(var b=-2;b<=2;b+=1)for(var L=-2;L<=2;L+=1)b==-2||b==2||L==-2||L==2||b==0&&L==0?n[d+b][h+L]=!0:n[d+b][h+L]=!1}},K=function(o){for(var l=v.getBCHTypeNumber(a),s=0;s<18;s+=1){var d=!o&&(l>>s&1)==1;n[Math.floor(s/3)][s%3+r-8-3]=d}for(var s=0;s<18;s+=1){var d=!o&&(l>>s&1)==1;n[s%3+r-8-3][Math.floor(s/3)]=d}},W=function(o,l){for(var s=p<<3|l,d=v.getBCHTypeInfo(s),h=0;h<15;h+=1){var b=!o&&(d>>h&1)==1;h<6?n[h][8]=b:h<8?n[h+1][8]=b:n[r-15+h][8]=b}for(var h=0;h<15;h+=1){var b=!o&&(d>>h&1)==1;h<8?n[8][r-h-1]=b:h<9?n[8][15-h-1+1]=b:n[8][15-h-1]=b}n[r-8][8]=!o},X=function(o,l){for(var s=-1,d=r-1,h=7,b=0,L=v.getMaskFunction(l),E=r-1;E>0;E-=2)for(E==6&&(E-=1);;){for(var I=0;I<2;I+=1)if(n[d][E-I]==null){var F=!1;b<o.length&&(F=(o[b]>>>h&1)==1);var x=L(d,E-I);x&&(F=!F),n[d][E-I]=F,h-=1,h==-1&&(b+=1,h=7)}if(d+=s,d<0||r<=d){d-=s,s=-s;break}}},z=function(o,l){for(var s=0,d=0,h=0,b=new Array(l.length),L=new Array(l.length),E=0;E<l.length;E+=1){var I=l[E].dataCount,F=l[E].totalCount-I;d=Math.max(d,I),h=Math.max(h,F),b[E]=new Array(I);for(var x=0;x<b[E].length;x+=1)b[E][x]=255&o.getBuffer()[x+s];s+=I;var H=v.getErrorCorrectPolynomial(F),U=C(b[E],H.getLength()-1),le=U.mod(H);L[E]=new Array(H.getLength()-1);for(var x=0;x<L[E].length;x+=1){var ue=x+le.getLength()-L[E].length;L[E][x]=ue>=0?le.getAt(ue):0}}for(var de=0,x=0;x<l.length;x+=1)de+=l[x].totalCount;for(var te=new Array(de),ee=0,x=0;x<d;x+=1)for(var E=0;E<l.length;E+=1)x<b[E].length&&(te[ee]=b[E][x],ee+=1);for(var x=0;x<h;x+=1)for(var E=0;E<l.length;E+=1)x<L[E].length&&(te[ee]=L[E][x],ee+=1);return te},ge=function(o,l,s){for(var d=D.getRSBlocks(o,l),h=B(),b=0;b<s.length;b+=1){var L=s[b];h.put(L.getMode(),4),h.put(L.getLength(),v.getLengthInBits(L.getMode(),o)),L.write(h)}for(var E=0,b=0;b<d.length;b+=1)E+=d[b].dataCount;if(h.getLengthInBits()>E*8)throw"code length overflow. ("+h.getLengthInBits()+">"+E*8+")";for(h.getLengthInBits()+4<=E*8&&h.put(0,4);h.getLengthInBits()%8!=0;)h.putBit(!1);for(;!(h.getLengthInBits()>=E*8||(h.put(g,8),h.getLengthInBits()>=E*8));)h.put(_,8);return z(h,d)};f.addData=function(o,l){l=l||"Byte";var s=null;switch(l){case"Numeric":s=N(o);break;case"Alphanumeric":s=P(o);break;case"Byte":s=S(o);break;case"Kanji":s=q(o);break;default:throw"mode:"+l}u.push(s),m=null},f.isDark=function(o,l){if(o<0||r<=o||l<0||r<=l)throw o+","+l;return n[o][l]},f.getModuleCount=function(){return r},f.make=function(){if(a<1){for(var o=1;o<40;o++){for(var l=D.getRSBlocks(o,p),s=B(),d=0;d<u.length;d++){var h=u[d];s.put(h.getMode(),4),s.put(h.getLength(),v.getLengthInBits(h.getMode(),o)),h.write(s)}for(var b=0,d=0;d<l.length;d++)b+=l[d].dataCount;if(s.getLengthInBits()<=b*8)break}a=o}T(!1,k())},f.createTableTag=function(o,l){o=o||2,l=typeof l>"u"?o*4:l;var s="";s+='<table style="',s+=" border-width: 0px; border-style: none;",s+=" border-collapse: collapse;",s+=" padding: 0px; margin: "+l+"px;",s+='">',s+="<tbody>";for(var d=0;d<f.getModuleCount();d+=1){s+="<tr>";for(var h=0;h<f.getModuleCount();h+=1)s+='<td style="',s+=" border-width: 0px; border-style: none;",s+=" border-collapse: collapse;",s+=" padding: 0px; margin: 0px;",s+=" width: "+o+"px;",s+=" height: "+o+"px;",s+=" background-color: ",s+=f.isDark(d,h)?"#000000":"#ffffff",s+=";",s+='"/>';s+="</tr>"}return s+="</tbody>",s+="</table>",s},f.createSvgTag=function(o,l,s,d){var h={};typeof arguments[0]=="object"&&(h=arguments[0],o=h.cellSize,l=h.margin,s=h.alt,d=h.title),o=o||2,l=typeof l>"u"?o*4:l,s=typeof s=="string"?{text:s}:s||{},s.text=s.text||null,s.id=s.text?s.id||"qrcode-description":null,d=typeof d=="string"?{text:d}:d||{},d.text=d.text||null,d.id=d.text?d.id||"qrcode-title":null;var b=f.getModuleCount()*o+l*2,L,E,I,F,x="",H;for(H="l"+o+",0 0,"+o+" -"+o+",0 0,-"+o+"z ",x+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',x+=h.scalable?"":' width="'+b+'px" height="'+b+'px"',x+=' viewBox="0 0 '+b+" "+b+'" ',x+=' preserveAspectRatio="xMinYMin meet"',x+=d.text||s.text?' role="img" aria-labelledby="'+j([d.id,s.id].join(" ").trim())+'"':"",x+=">",x+=d.text?'<title id="'+j(d.id)+'">'+j(d.text)+"</title>":"",x+=s.text?'<description id="'+j(s.id)+'">'+j(s.text)+"</description>":"",x+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',x+='<path d="',I=0;I<f.getModuleCount();I+=1)for(F=I*o+l,L=0;L<f.getModuleCount();L+=1)f.isDark(I,L)&&(E=L*o+l,x+="M"+E+","+F+H);return x+='" stroke="transparent" fill="black"/>',x+="</svg>",x},f.createDataURL=function(o,l){o=o||2,l=typeof l>"u"?o*4:l;var s=f.getModuleCount()*o+l*2,d=l,h=s-l;return Y(s,s,function(b,L){if(d<=b&&b<h&&d<=L&&L<h){var E=Math.floor((b-d)/o),I=Math.floor((L-d)/o);return f.isDark(I,E)?0:1}else return 1})},f.createImgTag=function(o,l,s){o=o||2,l=typeof l>"u"?o*4:l;var d=f.getModuleCount()*o+l*2,h="";return h+="<img",h+=' src="',h+=f.createDataURL(o,l),h+='"',h+=' width="',h+=d,h+='"',h+=' height="',h+=d,h+='"',s&&(h+=' alt="',h+=j(s),h+='"'),h+="/>",h};var j=function(o){for(var l="",s=0;s<o.length;s+=1){var d=o.charAt(s);switch(d){case"<":l+="&lt;";break;case">":l+="&gt;";break;case"&":l+="&amp;";break;case'"':l+="&quot;";break;default:l+=d;break}}return l},_e=function(o){var l=1;o=typeof o>"u"?l*2:o;var s=f.getModuleCount()*l+o*2,d=o,h=s-o,b,L,E,I,F,x={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},H={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},U="";for(b=0;b<s;b+=2){for(E=Math.floor((b-d)/l),I=Math.floor((b+1-d)/l),L=0;L<s;L+=1)F="\u2588",d<=L&&L<h&&d<=b&&b<h&&f.isDark(E,Math.floor((L-d)/l))&&(F=" "),d<=L&&L<h&&d<=b+1&&b+1<h&&f.isDark(I,Math.floor((L-d)/l))?F+=" ":F+="\u2588",U+=o<1&&b+1>=h?H[F]:x[F];U+=`
`}return s%2&&o>0?U.substring(0,U.length-s-1)+Array(s+1).join("\u2580"):U.substring(0,U.length-1)};return f.createASCII=function(o,l){if(o=o||1,o<2)return _e(l);o-=1,l=typeof l>"u"?o*2:l;var s=f.getModuleCount()*o+l*2,d=l,h=s-l,b,L,E,I,F=Array(o+1).join("\u2588\u2588"),x=Array(o+1).join("  "),H="",U="";for(b=0;b<s;b+=1){for(E=Math.floor((b-d)/o),U="",L=0;L<s;L+=1)I=1,d<=L&&L<h&&d<=b&&b<h&&f.isDark(E,Math.floor((L-d)/o))&&(I=0),U+=I?F:x;for(E=0;E<o;E+=1)H+=U+`
`}return H.substring(0,H.length-1)},f.renderTo2dContext=function(o,l){l=l||2;for(var s=f.getModuleCount(),d=0;d<s;d++)for(var h=0;h<s;h++)o.fillStyle=f.isDark(d,h)?"black":"white",o.fillRect(d*l,h*l,l,l)},f};R.stringToBytesFuncs={default:function(w){for(var y=[],g=0;g<w.length;g+=1){var _=w.charCodeAt(g);y.push(_&255)}return y}},R.stringToBytes=R.stringToBytesFuncs.default,R.createStringToBytes=function(w,y){var g=(function(){for(var a=J(w),p=function(){var M=a.read();if(M==-1)throw"eof";return M},n=0,r={};;){var m=a.read();if(m==-1)break;var u=p(),f=p(),T=p(),A=String.fromCharCode(m<<8|u),k=f<<8|T;r[A]=k,n+=1}if(n!=y)throw n+" != "+y;return r})(),_=63;return function(a){for(var p=[],n=0;n<a.length;n+=1){var r=a.charCodeAt(n);if(r<128)p.push(r);else{var m=g[a.charAt(n)];typeof m=="number"?(m&255)==m?p.push(m):(p.push(m>>>8),p.push(m&255)):p.push(_)}}return p}};var e={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},t={L:1,M:0,Q:3,H:2},i={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},v=(function(){var w=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],y=1335,g=7973,_=21522,a={},p=function(n){for(var r=0;n!=0;)r+=1,n>>>=1;return r};return a.getBCHTypeInfo=function(n){for(var r=n<<10;p(r)-p(y)>=0;)r^=y<<p(r)-p(y);return(n<<10|r)^_},a.getBCHTypeNumber=function(n){for(var r=n<<12;p(r)-p(g)>=0;)r^=g<<p(r)-p(g);return n<<12|r},a.getPatternPosition=function(n){return w[n-1]},a.getMaskFunction=function(n){switch(n){case i.PATTERN000:return function(r,m){return(r+m)%2==0};case i.PATTERN001:return function(r,m){return r%2==0};case i.PATTERN010:return function(r,m){return m%3==0};case i.PATTERN011:return function(r,m){return(r+m)%3==0};case i.PATTERN100:return function(r,m){return(Math.floor(r/2)+Math.floor(m/3))%2==0};case i.PATTERN101:return function(r,m){return r*m%2+r*m%3==0};case i.PATTERN110:return function(r,m){return(r*m%2+r*m%3)%2==0};case i.PATTERN111:return function(r,m){return(r*m%3+(r+m)%2)%2==0};default:throw"bad maskPattern:"+n}},a.getErrorCorrectPolynomial=function(n){for(var r=C([1],0),m=0;m<n;m+=1)r=r.multiply(C([1,c.gexp(m)],0));return r},a.getLengthInBits=function(n,r){if(1<=r&&r<10)switch(n){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw"mode:"+n}else if(r<27)switch(n){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw"mode:"+n}else if(r<41)switch(n){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw"mode:"+n}else throw"type:"+r},a.getLostPoint=function(n){for(var r=n.getModuleCount(),m=0,u=0;u<r;u+=1)for(var f=0;f<r;f+=1){for(var T=0,A=n.isDark(u,f),k=-1;k<=1;k+=1)if(!(u+k<0||r<=u+k))for(var M=-1;M<=1;M+=1)f+M<0||r<=f+M||k==0&&M==0||A==n.isDark(u+k,f+M)&&(T+=1);T>5&&(m+=3+T-5)}for(var u=0;u<r-1;u+=1)for(var f=0;f<r-1;f+=1){var O=0;n.isDark(u,f)&&(O+=1),n.isDark(u+1,f)&&(O+=1),n.isDark(u,f+1)&&(O+=1),n.isDark(u+1,f+1)&&(O+=1),(O==0||O==4)&&(m+=3)}for(var u=0;u<r;u+=1)for(var f=0;f<r-6;f+=1)n.isDark(u,f)&&!n.isDark(u,f+1)&&n.isDark(u,f+2)&&n.isDark(u,f+3)&&n.isDark(u,f+4)&&!n.isDark(u,f+5)&&n.isDark(u,f+6)&&(m+=40);for(var f=0;f<r;f+=1)for(var u=0;u<r-6;u+=1)n.isDark(u,f)&&!n.isDark(u+1,f)&&n.isDark(u+2,f)&&n.isDark(u+3,f)&&n.isDark(u+4,f)&&!n.isDark(u+5,f)&&n.isDark(u+6,f)&&(m+=40);for(var K=0,f=0;f<r;f+=1)for(var u=0;u<r;u+=1)n.isDark(u,f)&&(K+=1);var W=Math.abs(100*K/r/r-50)/5;return m+=W*10,m},a})(),c=(function(){for(var w=new Array(256),y=new Array(256),g=0;g<8;g+=1)w[g]=1<<g;for(var g=8;g<256;g+=1)w[g]=w[g-4]^w[g-5]^w[g-6]^w[g-8];for(var g=0;g<255;g+=1)y[w[g]]=g;var _={};return _.glog=function(a){if(a<1)throw"glog("+a+")";return y[a]},_.gexp=function(a){for(;a<0;)a+=255;for(;a>=256;)a-=255;return w[a]},_})();function C(w,y){if(typeof w.length>"u")throw w.length+"/"+y;var g=(function(){for(var a=0;a<w.length&&w[a]==0;)a+=1;for(var p=new Array(w.length-a+y),n=0;n<w.length-a;n+=1)p[n]=w[n+a];return p})(),_={};return _.getAt=function(a){return g[a]},_.getLength=function(){return g.length},_.multiply=function(a){for(var p=new Array(_.getLength()+a.getLength()-1),n=0;n<_.getLength();n+=1)for(var r=0;r<a.getLength();r+=1)p[n+r]^=c.gexp(c.glog(_.getAt(n))+c.glog(a.getAt(r)));return C(p,0)},_.mod=function(a){if(_.getLength()-a.getLength()<0)return _;for(var p=c.glog(_.getAt(0))-c.glog(a.getAt(0)),n=new Array(_.getLength()),r=0;r<_.getLength();r+=1)n[r]=_.getAt(r);for(var r=0;r<a.getLength();r+=1)n[r]^=c.gexp(c.glog(a.getAt(r))+p);return C(n,0).mod(a)},_}var D=(function(){var w=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],y=function(a,p){var n={};return n.totalCount=a,n.dataCount=p,n},g={},_=function(a,p){switch(p){case t.L:return w[(a-1)*4+0];case t.M:return w[(a-1)*4+1];case t.Q:return w[(a-1)*4+2];case t.H:return w[(a-1)*4+3];default:return}};return g.getRSBlocks=function(a,p){var n=_(a,p);if(typeof n>"u")throw"bad rs block @ typeNumber:"+a+"/errorCorrectionLevel:"+p;for(var r=n.length/3,m=[],u=0;u<r;u+=1)for(var f=n[u*3+0],T=n[u*3+1],A=n[u*3+2],k=0;k<f;k+=1)m.push(y(T,A));return m},g})(),B=function(){var w=[],y=0,g={};return g.getBuffer=function(){return w},g.getAt=function(_){var a=Math.floor(_/8);return(w[a]>>>7-_%8&1)==1},g.put=function(_,a){for(var p=0;p<a;p+=1)g.putBit((_>>>a-p-1&1)==1)},g.getLengthInBits=function(){return y},g.putBit=function(_){var a=Math.floor(y/8);w.length<=a&&w.push(0),_&&(w[a]|=128>>>y%8),y+=1},g},N=function(w){var y=e.MODE_NUMBER,g=w,_={};_.getMode=function(){return y},_.getLength=function(n){return g.length},_.write=function(n){for(var r=g,m=0;m+2<r.length;)n.put(a(r.substring(m,m+3)),10),m+=3;m<r.length&&(r.length-m==1?n.put(a(r.substring(m,m+1)),4):r.length-m==2&&n.put(a(r.substring(m,m+2)),7))};var a=function(n){for(var r=0,m=0;m<n.length;m+=1)r=r*10+p(n.charAt(m));return r},p=function(n){if("0"<=n&&n<="9")return n.charCodeAt(0)-48;throw"illegal char :"+n};return _},P=function(w){var y=e.MODE_ALPHA_NUM,g=w,_={};_.getMode=function(){return y},_.getLength=function(p){return g.length},_.write=function(p){for(var n=g,r=0;r+1<n.length;)p.put(a(n.charAt(r))*45+a(n.charAt(r+1)),11),r+=2;r<n.length&&p.put(a(n.charAt(r)),6)};var a=function(p){if("0"<=p&&p<="9")return p.charCodeAt(0)-48;if("A"<=p&&p<="Z")return p.charCodeAt(0)-65+10;switch(p){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+p}};return _},S=function(w){var y=e.MODE_8BIT_BYTE,g=w,_=R.stringToBytes(w),a={};return a.getMode=function(){return y},a.getLength=function(p){return _.length},a.write=function(p){for(var n=0;n<_.length;n+=1)p.put(_[n],8)},a},q=function(w){var y=e.MODE_KANJI,g=w,_=R.stringToBytesFuncs.SJIS;if(!_)throw"sjis not supported.";(function(n,r){var m=_(n);if(m.length!=2||(m[0]<<8|m[1])!=r)throw"sjis not supported."})("\u53CB",38726);var a=_(w),p={};return p.getMode=function(){return y},p.getLength=function(n){return~~(a.length/2)},p.write=function(n){for(var r=a,m=0;m+1<r.length;){var u=(255&r[m])<<8|255&r[m+1];if(33088<=u&&u<=40956)u-=33088;else if(57408<=u&&u<=60351)u-=49472;else throw"illegal char at "+(m+1)+"/"+u;u=(u>>>8&255)*192+(u&255),n.put(u,13),m+=2}if(m<r.length)throw"illegal char at "+(m+1)},p},$=function(){var w=[],y={};return y.writeByte=function(g){w.push(g&255)},y.writeShort=function(g){y.writeByte(g),y.writeByte(g>>>8)},y.writeBytes=function(g,_,a){_=_||0,a=a||g.length;for(var p=0;p<a;p+=1)y.writeByte(g[p+_])},y.writeString=function(g){for(var _=0;_<g.length;_+=1)y.writeByte(g.charCodeAt(_))},y.toByteArray=function(){return w},y.toString=function(){var g="";g+="[";for(var _=0;_<w.length;_+=1)_>0&&(g+=","),g+=w[_];return g+="]",g},y},Q=function(){var w=0,y=0,g=0,_="",a={},p=function(r){_+=String.fromCharCode(n(r&63))},n=function(r){if(!(r<0)){if(r<26)return 65+r;if(r<52)return 97+(r-26);if(r<62)return 48+(r-52);if(r==62)return 43;if(r==63)return 47}throw"n:"+r};return a.writeByte=function(r){for(w=w<<8|r&255,y+=8,g+=1;y>=6;)p(w>>>y-6),y-=6},a.flush=function(){if(y>0&&(p(w<<6-y),w=0,y=0),g%3!=0)for(var r=3-g%3,m=0;m<r;m+=1)_+="="},a.toString=function(){return _},a},J=function(w){var y=w,g=0,_=0,a=0,p={};p.read=function(){for(;a<8;){if(g>=y.length){if(a==0)return-1;throw"unexpected end of file./"+a}var r=y.charAt(g);if(g+=1,r=="=")return a=0,-1;if(r.match(/^\s$/))continue;_=_<<6|n(r.charCodeAt(0)),a+=6}var m=_>>>a-8&255;return a-=8,m};var n=function(r){if(65<=r&&r<=90)return r-65;if(97<=r&&r<=122)return r-97+26;if(48<=r&&r<=57)return r-48+52;if(r==43)return 62;if(r==47)return 63;throw"c:"+r};return p},V=function(w,y){var g=w,_=y,a=new Array(w*y),p={};p.setPixel=function(u,f,T){a[f*g+u]=T},p.write=function(u){u.writeString("GIF87a"),u.writeShort(g),u.writeShort(_),u.writeByte(128),u.writeByte(0),u.writeByte(0),u.writeByte(0),u.writeByte(0),u.writeByte(0),u.writeByte(255),u.writeByte(255),u.writeByte(255),u.writeString(","),u.writeShort(0),u.writeShort(0),u.writeShort(g),u.writeShort(_),u.writeByte(0);var f=2,T=r(f);u.writeByte(f);for(var A=0;T.length-A>255;)u.writeByte(255),u.writeBytes(T,A,255),A+=255;u.writeByte(T.length-A),u.writeBytes(T,A,T.length-A),u.writeByte(0),u.writeString(";")};var n=function(u){var f=u,T=0,A=0,k={};return k.write=function(M,O){if(M>>>O)throw"length over";for(;T+O>=8;)f.writeByte(255&(M<<T|A)),O-=8-T,M>>>=8-T,A=0,T=0;A=M<<T|A,T=T+O},k.flush=function(){T>0&&f.writeByte(A)},k},r=function(u){for(var f=1<<u,T=(1<<u)+1,A=u+1,k=m(),M=0;M<f;M+=1)k.add(String.fromCharCode(M));k.add(String.fromCharCode(f)),k.add(String.fromCharCode(T));var O=$(),K=n(O);K.write(f,A);var W=0,X=String.fromCharCode(a[W]);for(W+=1;W<a.length;){var z=String.fromCharCode(a[W]);W+=1,k.contains(X+z)?X=X+z:(K.write(k.indexOf(X),A),k.size()<4095&&(k.size()==1<<A&&(A+=1),k.add(X+z)),X=z)}return K.write(k.indexOf(X),A),K.write(T,A),K.flush(),O.toByteArray()},m=function(){var u={},f=0,T={};return T.add=function(A){if(T.contains(A))throw"dup key:"+A;u[A]=f,f+=1},T.size=function(){return f},T.indexOf=function(A){return u[A]},T.contains=function(A){return typeof u[A]<"u"},T};return p},Y=function(w,y,g){for(var _=V(w,y),a=0;a<y;a+=1)for(var p=0;p<w;p+=1)_.setPixel(p,a,g(p,a));var n=$();_.write(n);for(var r=Q(),m=n.toByteArray(),u=0;u<m.length;u+=1)r.writeByte(m[u]);return r.flush(),"data:image/gif;base64,"+r};return R})();(function(){pe.stringToBytesFuncs["UTF-8"]=function(R){function e(t){for(var i=[],v=0;v<t.length;v++){var c=t.charCodeAt(v);c<128?i.push(c):c<2048?i.push(192|c>>6,128|c&63):c<55296||c>=57344?i.push(224|c>>12,128|c>>6&63,128|c&63):(v++,c=65536+((c&1023)<<10|t.charCodeAt(v)&1023),i.push(240|c>>18,128|c>>12&63,128|c>>6&63,128|c&63))}return i}return e(R)}})();var me=pe;var se=class extends HTMLElement{constructor(){super(),this._afterFrame=null,this._ownedFile=null,this._boundCopy=this.handleCopy.bind(this),this._boundOk=this.handleOk.bind(this),this._boundLinkClick=this.handleLinkClick.bind(this)}connectedCallback(){this.render()}disconnectedCallback(){this._afterFrame!==null&&(cancelAnimationFrame(this._afterFrame),this._afterFrame=null),this.unbindEventHandlers()}render(){let e=document.getElementById("upload-view-complete");if(!e){console.error("Template #upload-view-complete not found");return}let t=e.content.cloneNode(!0);this.innerHTML="",this.appendChild(t),this.bindEventHandlers(),this._afterFrame!==null&&cancelAnimationFrame(this._afterFrame),this._afterFrame=requestAnimationFrame(()=>{this._afterFrame=null,Z(this),this._ownedFile&&this.setUploadedFile(this._ownedFile)})}bindEventHandlers(){let e=this.querySelector('[data-action="copy"]'),t=this.querySelector('[data-action="ok"]'),i=this.querySelector('[data-role="download-link"]');e&&e.addEventListener("click",this._boundCopy),t&&t.addEventListener("click",this._boundOk),i&&i.addEventListener("click",this._boundLinkClick)}unbindEventHandlers(){let e=this.querySelector('[data-action="copy"]'),t=this.querySelector('[data-action="ok"]'),i=this.querySelector('[data-role="download-link"]');e&&e.removeEventListener("click",this._boundCopy),t&&t.removeEventListener("click",this._boundOk),i&&i.removeEventListener("click",this._boundLinkClick)}setUploadedFile(e){if(!e){console.warn("No ownedFile provided to setUploadedFile");return}this._ownedFile=e;let t=this.querySelector('[data-role="filename"]');t&&e.name&&(t.textContent=e.name);let i=this.querySelector('[data-role="download-link"]');i&&e.url&&(i.value=e.url,requestAnimationFrame(()=>{i.select(),i.focus()})),this.generateQRCode(e.url)}generateQRCode(e){if(!e)return;let t=this.querySelector('[data-role="qr-container"]');if(t)try{let i=me(0,"L");i.addData(e),i.make();let v=i.createSvgTag({scalable:!0,cellSize:4,margin:4});t.innerHTML=v;let c=t.querySelector("svg");c&&(c.style.maxWidth="200px",c.style.height="auto")}catch(i){console.error("Error generating QR code:",i),t.innerHTML='<p class="text-sm text-grey-60">QR code unavailable</p>'}}handleCopy(e){e.preventDefault();let t=this.querySelector('[data-role="download-link"]');if(!t||!t.value)return;let i=t.value;if(he(i)){this.dispatchEvent(new CustomEvent("copy",{bubbles:!0,detail:{url:i}}));let C=e.currentTarget.querySelector('[data-role="copy-icon"]');if(C){let D=C.className;C.className="ri-check-line text-lg leading-4",setTimeout(()=>{C.className=D},2e3)}}}handleOk(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("complete-acknowledged",{bubbles:!0,detail:{file:this._ownedFile}}))}handleLinkClick(e){e.currentTarget.select()}};customElements.define("upload-complete-view",se);var ae=class extends HTMLElement{constructor(){super(),this._afterFrame=null,this._errorMessage=null,this._boundRetry=this.handleRetry.bind(this),this._boundOk=this.handleOk.bind(this)}connectedCallback(){this.render()}disconnectedCallback(){this._afterFrame!==null&&(cancelAnimationFrame(this._afterFrame),this._afterFrame=null),this.unbindEventHandlers()}render(){let e=document.getElementById("upload-view-error");if(!e){console.error("Template #upload-view-error not found");return}let t=e.content.cloneNode(!0);this.innerHTML="",this.appendChild(t),this.bindEventHandlers(),this._afterFrame!==null&&cancelAnimationFrame(this._afterFrame),this._afterFrame=requestAnimationFrame(()=>{this._afterFrame=null,Z(this),this._errorMessage&&this.setErrorMessage(this._errorMessage)})}bindEventHandlers(){let e=this.querySelector('[data-action="retry"]'),t=this.querySelector('[data-action="ok"]');console.log("[UploadErrorView] Binding event handlers",{retryBtn:e,okBtn:t}),e&&e.addEventListener("click",this._boundRetry),t&&t.addEventListener("click",this._boundOk)}unbindEventHandlers(){let e=this.querySelector('[data-action="retry"]'),t=this.querySelector('[data-action="ok"]');e&&e.removeEventListener("click",this._boundRetry),t&&t.removeEventListener("click",this._boundOk)}setErrorMessage(e){this._errorMessage=e;let t=this.querySelector('[data-role="error-message"]');t&&e&&(t.textContent=e)}handleRetry(e){console.log("[UploadErrorView] Retry button clicked"),e.preventDefault(),this.dispatchEvent(new CustomEvent("retry",{bubbles:!0})),console.log("[UploadErrorView] Retry event dispatched")}handleOk(e){console.log("[UploadErrorView] OK button clicked"),e.preventDefault(),this.dispatchEvent(new CustomEvent("error-dismiss",{bubbles:!0})),console.log("[UploadErrorView] Error-dismiss event dispatched")}};customElements.define("upload-error-view",ae);var ve={empty:"upload-empty-view",list:"upload-list-view",uploading:"upload-uploading-view",complete:"upload-complete-view",error:"upload-error-view"},oe=class extends HTMLElement{constructor(){super(),this._currentView=null,this._currentViewKey=null,this._app=null,this._errorMessage=null,this._isComplete=!1,this._isError=!1,this._uploadedFile=null,this._boundPaste=this.handlePaste.bind(this)}connectedCallback(){this._app||(this._app=this.closest("go-send")),window.addEventListener("paste",this._boundPaste),this.refresh()}disconnectedCallback(){window.removeEventListener("paste",this._boundPaste),this._currentView=null}refresh(){let e=this._getAppState();if(!e)return;if(this._isError){this._ensureView("error"),this._configureErrorView();return}if(this._isComplete){this._ensureView("complete"),this._configureCompleteView();return}let t=e.archive,i=!!(e.uploading&&e.transfer),v=!!(t&&t.files&&t.files.length>0),c="empty";switch(i?c="uploading":v&&(c="list"),this._ensureView(c),c){case"empty":this._configureEmptyView(e);break;case"list":this._configureListView(e);break;case"uploading":this._configureUploadingView(e);break;default:break}this._applyErrorMessage()}setUploadButtonEnabled(e){this._currentViewKey==="list"&&this._currentView&&typeof this._currentView.setUploadEnabled=="function"&&this._currentView.setUploadEnabled(e)}updateProgress(e,t,i){this._currentViewKey==="uploading"&&this._currentView&&typeof this._currentView.updateProgress=="function"?this._currentView.updateProgress(e,t,i):this._currentViewKey==="list"&&this._currentView&&typeof this._currentView.updateProgress=="function"&&this._currentView.updateProgress(e,t,i)}updateProgressText(e){this._currentViewKey==="uploading"&&this._currentView&&typeof this._currentView.setStatus=="function"?this._currentView.setStatus(e):this._currentViewKey==="list"&&this._currentView&&typeof this._currentView.updateProgressText=="function"&&this._currentView.updateProgressText(e)}ensureView(e){this._ensureView(e)}setUploadedFile(e){this._isComplete=!0,this._uploadedFile=e,this._currentViewKey==="complete"&&this._currentView&&typeof this._currentView.setUploadedFile=="function"&&this._currentView.setUploadedFile(e)}clearComplete(){this._isComplete=!1,this._uploadedFile=null,this.refresh()}showErrorView(e){console.log("[UploadArea] showErrorView() called with message:",e),this._errorMessage=e,this._isComplete=!1,this._isError=!0,this._ensureView("error"),this._configureErrorView(),console.log("[UploadArea] Error view displayed")}clearError(){console.log("[UploadArea] clearError() called"),this._isError=!1,this._errorMessage=null,console.log("[UploadArea] Error state cleared, calling refresh()"),this.refresh()}_configureErrorView(){let e=this._currentView;!e||typeof e.setErrorMessage!="function"||this._errorMessage&&e.setErrorMessage(this._errorMessage)}_ensureView(e){if(this._currentViewKey===e&&this._currentView&&this._currentView.parentElement===this)return;this.innerHTML="";let t=ve[e]||ve.empty,i=document.createElement(t);this.appendChild(i),this._currentView=i,this._currentViewKey=e,this._applyErrorMessage()}_configureEmptyView(e){var B;let t=this._currentView;if(!t||typeof t.setConfig!="function")return;let i=e.LIMITS||{},v=G(i.MAX_FILE_SIZE||0),c=this._translate("orClickWithSize",`or click to select files (max ${v})`,{size:v},e),C=this._translate("addFilesButton","Select files",null,e),D=((B=e.WEB_UI)==null?void 0:B.UPLOAD_AREA_NOTICE_HTML)||"";t.setConfig({orClickText:c,addFilesLabel:C,noticeHTML:D})}_configureListView(e){let t=this._currentView;if(!t||typeof t.setState!="function")return;let i=e.archive,v=e.LIMITS||{},c=e.DEFAULTS||{};t.setState({files:(i==null?void 0:i.files)||[],totalSize:(i==null?void 0:i.size)||0,maxFiles:v.MAX_FILES_PER_ARCHIVE||0,limits:v,defaults:c,translate:e.translate,timeLimit:(i==null?void 0:i.timeLimit)??null,downloadLimit:(i==null?void 0:i.dlimit)??null,password:(i==null?void 0:i.password)??""})}showError(e){this._errorMessage=e||null,this._applyErrorMessage()}_applyErrorMessage(){this._currentView&&typeof this._currentView.setError=="function"&&this._currentView.setError(this._errorMessage)}_configureUploadingView(e){let t=this._currentView;if(!t)return;let i=e.archive;if(i&&typeof t.setFileInfo=="function"&&t.setFileInfo(i.name||"File",i.size||0),i&&typeof t.setExpiryInfo=="function"){let c=Date.now()+500+(i.timeLimit||0)*1e3,C=i.dlimit||1,D=c-Date.now(),B=ce(D),N=window.translate||($=>$),P=N("downloadCount",{num:C}),S=N(B.id,B),q=N("archiveExpiryInfo",{downloadCount:P,timespan:S});t.setExpiryInfo(q)}let v=e.transfer;if(v&&typeof t.updateProgress=="function"){let c=v.progressRatio||0,[C=0,D=0]=v.progress||[];t.updateProgress(c,C,D)}}_configureCompleteView(){let e=this._currentView;!e||!this._uploadedFile||typeof e.setUploadedFile=="function"&&e.setUploadedFile(this._uploadedFile)}_getAppState(){var e;return(!this._app||!this._app.state)&&(this._app=this.closest("go-send")),((e=this._app)==null?void 0:e.state)||null}_translate(e,t,i,v){let c=(v==null?void 0:v.translate)||window.translate;if(typeof c=="function")try{let C=c(e,i);if(C)return C}catch{}return t}async handlePaste(e){var D,B,N;let t=this._getAppState();if(!t||t.uploading||this._isComplete)return;let i=(D=e.target)==null?void 0:D.type;if(["password","text","email","textarea"].includes(i)||((B=e.target)==null?void 0:B.tagName)==="TEXTAREA")return;let v=Array.from(((N=e.clipboardData)==null?void 0:N.items)||[]),c=v.filter(P=>P.kind==="file"),C=v.filter(P=>P.kind==="string");if(c.length>0){let P=c.map(async(q,$)=>{let Q=q.getAsFile();if(!Q)return null;let J=await this._getStringFromItem(C[$]);return new File([Q],J||Q.name||"file",{type:Q.type})}),S=(await Promise.all(P)).filter(q=>!!q);S.length>0&&(e.preventDefault(),this.dispatchEvent(new CustomEvent("addfiles",{bubbles:!0,detail:{files:S}})))}else if(C.length>0){let P=await this._getStringFromItem(C[0]);if(P){e.preventDefault();let S=new File([P],"pasted.txt",{type:"text/plain"});this.dispatchEvent(new CustomEvent("addfiles",{bubbles:!0,detail:{files:[S]}}))}}}_getStringFromItem(e){return e?new Promise(t=>{e.getAsString(t)}):Promise.resolve("")}};customElements.define("upload-area",oe);
